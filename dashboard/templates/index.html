<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post9 Sports Investing Dashboard</title>
    <!-- TailwindCSS - Production ready build included in styles.css -->
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../static/styles.css">
    <style>
        body {
            background: linear-gradient(120deg, #0a1a2f 0%, #1e3350 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', 'Roboto', 'Arial', sans-serif;
        }
        .post9-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }
        .post9-title {
            font-size: 3.5rem;
            font-weight: 900;
            font-style: italic;
            color: #fff;
            letter-spacing: 2px;
            text-shadow: 0 2px 8px #0a1a2f;
        }
        .post9-accent {
            color: #ff9900;
            font-weight: 900;
        }
        .post9-tagline {
            font-size: 1.25rem;
            color: #ff9900;
            font-weight: 600;
            text-align: center;
            margin-top: 0.5rem;
            letter-spacing: 1px;
        }
        .metric-card, .table-container, .modal-content {
            background: rgba(255,255,255,0.95);
            border-radius: 1rem;
            box-shadow: 0 4px 24px rgba(10,26,47,0.12);
        }
        .nav-btn {
            font-size: 1.2rem;
            font-weight: 700;
            color: #fff;
            background: none;
            border: none;
            padding: 0.5rem 1.5rem;
            border-radius: 2rem;
            transition: background 0.2s, color 0.2s;
        }
        .nav-btn:hover {
            background: #ff9900;
            color: #0a1a2f;
        }
        .post9-btn {
            background: linear-gradient(90deg, #ff9900 0%, #ffb84d 100%);
            color: #0a1a2f;
            font-weight: 700;
            border-radius: 2rem;
            box-shadow: 0 2px 8px #ff9900a0;
            transition: transform 0.1s;
        }
        .post9-btn:hover {
            transform: scale(1.05);
            background: linear-gradient(90deg, #ffb84d 0%, #ff9900 100%);
        }
        .post9-card {
            border: 2px solid #ff9900;
            box-shadow: 0 2px 12px #ff990080;
        }
        /* Stats Grid Layout */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
        }
        .stats-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid transparent;
            transition: transform 0.3s, border-color 0.3s;
        }
        .stats-card:hover {
            transform: translateY(-5px);
            border-color: #ff9900;
        }
        .stats-icon {
            font-size: 2.5rem;
            display: block;
            margin-bottom: 0.5rem;
        }
        .stats-label {
            font-size: 0.875rem;
            color: #a0aec0;
            margin-bottom: 0.25rem;
        }
        .stats-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #fff;
            display: block;
            margin-bottom: 0.25rem;
        }
        .stats-trend {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 0.875rem;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            color: #fff;
        }
        .stats-trend.positive {
            background: rgba(76, 175, 80, 0.2);
        }
        .stats-trend.negative {
            background: rgba(244, 67, 54, 0.2);
        }
        
        /* Predictive Analytics Styles */
        .predictive-tab-btn {
            flex: 1;
            padding: 0.75rem 1rem;
            text-align: center;
            font-weight: 600;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            color: #9CA3AF;
            background: transparent;
            border: none;
            cursor: pointer;
        }
        .predictive-tab-btn.active {
            background: #ff9900;
            color: #0a1a2f;
        }
        .predictive-tab-btn:hover:not(.active) {
            color: #ffffff;
            background: rgba(255, 153, 0, 0.2);
        }
        .predictive-tab-content {
            min-height: 400px;
        }
        .predictive-tab-content.hidden {
            display: none;
        }
        
        /* Training Queue Styles */
        .training-tab-btn {
            background: transparent;
            color: #9CA3AF;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }
        
        .training-tab-btn.active, .training-tab-btn:hover {
            background: #374151;
            color: #fff;
        }
        
        .training-tab-content {
            background: rgba(255,255,255,0.05);
            border-radius: 0.5rem;
            padding: 1.5rem;
        }
        
        .training-job-card {
            background: rgba(255,255,255,0.08);
            border-radius: 0.5rem;
            padding: 1rem;
            border-left: 4px solid #10B981;
            transition: transform 0.2s;
        }
        
        .training-job-card:hover {
            transform: translateX(4px);
        }
        
        .training-job-card.running {
            border-left-color: #3B82F6;
        }
        
        .training-job-card.completed {
            border-left-color: #10B981;
        }
        
        .training-job-card.failed {
            border-left-color: #EF4444;
        }
        
        .training-job-card.queued {
            border-left-color: #F59E0B;
        }
        
        .progress-bar {
            background: rgba(255,255,255,0.1);
            border-radius: 1rem;
            height: 0.5rem;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #10B981, #34D399);
            height: 100%;
            border-radius: 1rem;
            transition: width 0.3s;
        }
        
        /* Tooltip Styles */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            border-bottom: 1px dotted #ff9900;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 280px;
            background-color: #1a2332;
            color: #fff;
            text-align: left;
            border-radius: 8px;
            padding: 12px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -140px;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
            font-size: 0.875rem;
            line-height: 1.4;
            border: 1px solid #ff9900;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #1a2332 transparent transparent transparent;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        .tooltip .tooltiptext strong {
            color: #ff9900;
            font-weight: 600;
        }
    </style>
    <script>
        function showPage(pageId) {
            const pages = ['dashboard-page', 'investments-page', 'strategy-builder-page', 'model-gallery-page', 'training-queue-page', 'predictive-analytics-page', 'analytics-page', 'account-page', 'admin-page'];
            pages.forEach(id => {
                const pageElement = document.getElementById(id);
                if (pageElement) {
                    pageElement.style.display = (id === pageId) ? 'block' : 'none';
                }
            });
            if (pageId === 'investments-page') {
                // Load cached investments instead of automatically refreshing
                if (typeof window.loadCachedInvestments === 'function') {
                    window.loadCachedInvestments();
                } else {
                    console.error("loadCachedInvestments is not defined.");
                }
            } else if (pageId === 'account-page') {
                // Load API status when account page is shown
                if (typeof window.refreshApiStatus === 'function') {
                    setTimeout(() => window.refreshApiStatus(), 100);
                }
            } else if (pageId === 'admin-page') {
                // Load system status when admin page is shown
                loadSystemStatus();
            }
        }
    </script>
</head>
<body class="flex flex-col items-center justify-start min-h-screen p-8">
    <!-- Demo Mode Warning Banner -->
    {% if demo_mode %}
    <div class="fixed top-0 left-0 right-0 z-50 bg-red-600 text-white text-center py-2 px-4 font-bold shadow-lg">
        <div class="flex items-center justify-center space-x-2">
            <span class="text-yellow-200">⚠️</span>
            <span>{{ demo_warning }}</span>
            <span class="text-yellow-200">⚠️</span>
        </div>
        <div class="text-sm mt-1 text-red-200">
            No real money, bots, or investments - This is demonstration mode only
        </div>
    </div>
    <div class="h-20"></div> <!-- Spacer for fixed banner -->
    {% endif %}
    <nav class="flex space-x-4 mb-6 flex-wrap">
        <button onclick="showPage('dashboard-page')" class="nav-btn">Dashboard</button>
        <button onclick="showPage('investments-page')" class="nav-btn">Available Investments</button>
        <button onclick="showPage('strategy-builder-page')" class="nav-btn">Strategy Builder</button>
        <button onclick="showPage('model-gallery-page')" class="nav-btn">Model Gallery</button>
        <button onclick="showPage('training-queue-page')" class="nav-btn">🔥 Training Queue</button>
        <button onclick="showPage('predictive-analytics-page')" class="nav-btn">🔮 Predictive Analytics</button>
        <button onclick="showPage('analytics-page')" class="nav-btn">Advanced Analytics</button>
        <a href="/scores" class="nav-btn">🏆 Scores & Standings</a>
        <button onclick="showPage('admin-page')" class="nav-btn">⚙️ System Status</button>
        <button onclick="showPage('account-page')" class="nav-btn">Account</button>
    </nav>
    <div id="message-box" class="message-box"></div>
    <div id="loading-spinner" class="spinner hidden"></div>
    <div class="container mx-auto">
        <header class="text-center mb-8">
            <div class="post9-logo mb-2">
                <span class="post9-title">Post<span class="post9-accent">9</span></span>
            </div>
            <div class="post9-tagline">Stop Betting. Start Investing.</div>
            <p class="text-xl text-gray-300 mt-2">Professional Analytics & Automated Investor Management</p>
            <p class="text-sm text-gray-400 mt-2">User ID: <span id="user-id">Loading...</span></p>
        </header>
        <div id="dashboard-page">
            <section id="overall-stats-section" class="mb-12">
                <h2 class="text-2xl font-bold mb-6 text-white">Overall Stats</h2>
                <div id="stats-container" class="stats-grid">
                    <div class="stats-card">
                        <span class="stats-icon">💰</span>
                        <span class="stats-label">Total Profit</span>
                        <span id="total-profit" class="stats-value">$0.00</span>
                        <span class="stats-trend" id="profit-trend"></span>
                    </div>
                    <div class="stats-card">
                        <span class="stats-icon">🎲</span>
                        <span class="stats-label">Total Wagers</span>
                        <span id="total-wagers" class="stats-value">0</span>
                    </div>
                    <div class="stats-card">
                        <span class="stats-icon">🏆</span>
                        <span class="stats-label">Win Rate</span>
                        <span id="win-rate" class="stats-value">0.00%</span>
                    </div>
                    <div class="stats-card">
                        <span class="stats-icon">🚀</span>
                        <span class="stats-label">Best Investor</span>
                        <span id="best-bot-name" class="stats-value">-</span>
                        <span id="best-bot-profit" class="stats-trend"></span>
                    </div>
                    <div class="stats-card">
                        <span class="stats-icon">⚠️</span>
                        <span class="stats-label">Worst Investor</span>
                        <span id="worst-bot-name" class="stats-value">-</span>
                        <span id="worst-bot-profit" class="stats-trend negative"></span>
                    </div>
                    <div class="stats-card">
                        <span class="stats-icon">🤖</span>
                        <span class="stats-label">ML Models</span>
                        <span id="ml-models-active" class="stats-value">3</span>
                        <span class="stats-trend positive" id="ml-models-trend">Active</span>
                    </div>
                    <div class="stats-card">
                        <span class="stats-icon">🎯</span>
                        <span class="stats-label">ML Accuracy</span>
                        <span id="ml-accuracy" class="stats-value">67.5%</span>
                        <span class="stats-trend positive" id="ml-accuracy-trend">▲ +2.1%</span>
                    </div>
                </div>
                <div id="stats-breakdown-inline"></div>
            </section>
            <section class="table-container mb-12 post9-card">
                <h2 class="text-2xl font-bold mb-4 text-white">Active Investors</h2>
                <div id="active-bots-container" class="overflow-x-auto rounded-lg shadow-sm post9-card">
                    <p id="active-bots-loading" class="text-center text-gray-500">Loading active investors...</p>
                </div>
            </section>
            <section class="table-container mb-12 post9-card">
                <h2 class="text-2xl font-bold mb-4 text-white">Investor Manager</h2>
                <button type="button" class="post9-btn p-3 mb-4" onclick="showModal('add-bot-modal')">Add Investor</button>
                <div id="inactive-bots-container" class="overflow-x-auto rounded-lg shadow-sm post9-card">
                    <p id="inactive-bots-loading" class="text-center text-gray-500">Loading inactive investors...</p>
                </div>
            </section>
            <section class="table-container post9-card">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-white">Strategy Manager</h2>
                    <div class="flex gap-3">
                        <button type="button" class="post9-btn p-3" onclick="showModal('strategy-templates-modal')">📋 Templates</button>
                        <button type="button" class="post9-btn p-3" onclick="showModal('add-strategy-modal')">+ Custom Strategy</button>
                    </div>
                </div>
                
                <!-- Quick Strategy Templates -->
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3 text-white">Quick Templates</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="bg-gradient-to-br from-green-500 to-green-700 p-4 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('positive_ev')">
                            <div class="text-2xl mb-2">💰</div>
                            <div class="font-bold">+eV Template</div>
                            <div class="text-sm opacity-90">Expected Value based betting</div>
                        </div>
                        <div class="bg-gradient-to-br from-blue-500 to-blue-700 p-4 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('conservative')">
                            <div class="text-2xl mb-2">🛡️</div>
                            <div class="font-bold">Conservative</div>
                            <div class="text-sm opacity-90">Low risk, steady gains</div>
                        </div>
                        <div class="bg-gradient-to-br from-orange-500 to-red-600 p-4 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('aggressive')">
                            <div class="text-2xl mb-2">🚀</div>
                            <div class="font-bold">Aggressive</div>
                            <div class="text-sm opacity-90">High risk, high reward</div>
                        </div>
                        <div class="bg-gradient-to-br from-purple-500 to-purple-700 p-4 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('recovery')">
                            <div class="text-2xl mb-2">🔄</div>
                            <div class="font-bold">Loss Recovery</div>
                            <div class="text-sm opacity-90">Recover from losses</div>
                        </div>
                    </div>
                </div>
                
                <div id="strategies-container" class="overflow-x-auto rounded-lg shadow-sm post9-card">
                    <p id="strategies-loading" class="text-center text-gray-500">Loading strategies...</p>
                </div>
            </section>
        </div>
        <!-- Add Investor Modal -->
        <div id="add-bot-modal" class="modal">
            <div class="modal-content post9-card">
                <span class="modal-close" onclick="closeModal('add-bot-modal')">&times;</span>
                <h3 class="text-xl font-bold mb-4 text-white">Add Automated Investor</h3>
                <form id="add-bot-form" class="flex flex-col gap-4">
                    <input type="text" name="name" placeholder="Investor Name" required>
                    
                    <!-- Step 1: Model Selection (Primary) -->
                    <div class="bg-blue-50 p-3 rounded-lg border border-blue-200">
                        <label class="block text-sm font-medium text-gray-700 mb-2">1. Select Model</label>
                        <select name="model_id" id="model-select" required onchange="onModelSelected(this.value)">
                            <option value="">Choose a trained model...</option>
                            <option value="nba_advanced_lstm" data-sport="NBA">NBA Advanced LSTM (68.2% accuracy)</option>
                            <option value="nfl_ensemble_v2" data-sport="NFL">NFL Ensemble v2.0 (64.8% accuracy)</option>
                            <option value="mlb_statistical" data-sport="MLB">MLB Statistical (61.5% accuracy)</option>
                            <option value="nba_ensemble" data-sport="NBA">NBA Ensemble (71.4% accuracy)</option>
                            <option value="nfl_neural" data-sport="NFL">NFL Neural Network (66.1% accuracy)</option>
                        </select>
                        <small class="text-gray-600">The model determines the sport and prediction capabilities</small>
                    </div>
                    
                    <!-- Step 2: Sport (Auto-populated) -->
                    <div class="bg-green-50 p-3 rounded-lg border border-green-200">
                        <label class="block text-sm font-medium text-gray-700 mb-2">2. Sport (Auto-selected from Model)</label>
                        <input type="text" name="sport" id="sport-display" readonly placeholder="Select a model first..." class="bg-gray-100 cursor-not-allowed">
                        <small class="text-gray-600">Automatically determined by the selected model</small>
                    </div>
                    
                    <!-- Step 3: Market Selection -->
                    <div class="bg-orange-50 p-3 rounded-lg border border-orange-200">
                        <label class="block text-sm font-medium text-gray-700 mb-2">3. Select Market</label>
                        <select name="bet_type" id="market-select" required disabled>
                            <option value="">Choose market type...</option>
                            <option value="Moneyline">Moneyline (Win/Loss)</option>
                            <option value="Spread">Spread (Point Spread)</option>
                            <option value="Totals">Totals (Over/Under)</option>
                        </select>
                        <small class="text-gray-600">Choose which market to bet on</small>
                    </div>
                    
                    <!-- Risk Management Configuration -->
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Risk Management</label>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <input type="number" name="starting_balance" placeholder="Starting Balance ($)" required>
                            <input type="number" name="bet_percentage" placeholder="Max Bet % (1-10%)" min="0.1" max="10" step="0.1" value="2.0" required>
                            <input type="number" name="max_bets_per_week" placeholder="Max Bets/Week" min="1" max="50" value="5" required>
                            <input type="number" name="max_bets_per_day" placeholder="Max Bets/Day" min="1" max="10" value="2">
                            <input type="number" name="minimum_confidence" placeholder="Min Confidence %" min="50" max="95" value="65" step="1">
                            <input type="number" name="stop_loss_percentage" placeholder="Stop Loss %" min="5" max="50" value="10" step="1">
                            <input type="number" name="kelly_fraction" placeholder="Kelly Fraction" min="0.1" max="1.0" value="0.25" step="0.05">
                            <select name="strategy_id" id="strategy-select">
                                <option value="">Select Strategy (Optional)</option>
                            </select>
                        </div>
                        <div class="mt-2 text-xs text-gray-600">
                            <p><strong>Kelly Fraction:</strong> Fraction of full Kelly Criterion to use (0.25 = 25% of Kelly)</p>
                            <p><strong>Stop Loss:</strong> Automatically pause bot if balance drops by this percentage</p>
                        </div>
                    </div>
                    
                    <button type="submit" class="post9-btn p-3 mt-2" id="add-bot-submit" disabled>Add Investor</button>
                </form>
            </div>
        </div>
        
        <!-- Strategy Templates Modal -->
        <div id="strategy-templates-modal" class="modal">
            <div class="modal-content post9-card max-w-4xl">
                <span class="modal-close" onclick="closeModal('strategy-templates-modal')">&times;</span>
                <h3 class="text-2xl font-bold mb-6 text-white">Strategy Templates</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- +eV Template -->
                    <div class="bg-gradient-to-br from-green-500 to-green-700 p-6 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('positive_ev')">
                        <div class="text-4xl mb-4">💰</div>
                        <h4 class="text-xl font-bold mb-2">Expected Value (+eV)</h4>
                        <p class="text-sm opacity-90 mb-4">Focus on bets with positive expected value. Calculates probability vs. odds to find profitable opportunities.</p>
                        <div class="text-xs bg-black bg-opacity-30 p-2 rounded">
                            <strong>Logic:</strong> IF (Expected Value > 5%) THEN Place Bet
                        </div>
                    </div>
                    
                    <!-- Conservative Template -->
                    <div class="bg-gradient-to-br from-blue-500 to-blue-700 p-6 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('conservative')">
                        <div class="text-4xl mb-4">🛡️</div>
                        <h4 class="text-xl font-bold mb-2">Conservative Strategy</h4>
                        <p class="text-sm opacity-90 mb-4">Low risk approach with smaller bet sizes and higher confidence requirements.</p>
                        <div class="text-xs bg-black bg-opacity-30 p-2 rounded">
                            <strong>Logic:</strong> IF (Confidence > 75% AND Odds < 2.0) THEN Bet 1-2%
                        </div>
                    </div>
                    
                    <!-- Aggressive Template -->
                    <div class="bg-gradient-to-br from-orange-500 to-red-600 p-6 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('aggressive')">
                        <div class="text-4xl mb-4">🚀</div>
                        <h4 class="text-xl font-bold mb-2">Aggressive Strategy</h4>
                        <p class="text-sm opacity-90 mb-4">Higher risk, higher reward with larger bet sizes and more frequent betting.</p>
                        <div class="text-xs bg-black bg-opacity-30 p-2 rounded">
                            <strong>Logic:</strong> IF (Confidence > 60% AND Value > 3%) THEN Bet 3-5%
                        </div>
                    </div>
                    
                    <!-- Recovery Template -->
                    <div class="bg-gradient-to-br from-purple-500 to-purple-700 p-6 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('recovery')">
                        <div class="text-4xl mb-4">🔄</div>
                        <h4 class="text-xl font-bold mb-2">Loss Recovery</h4>
                        <p class="text-sm opacity-90 mb-4">Recover losses with calculated risk management and progressive betting.</p>
                        <div class="text-xs bg-black bg-opacity-30 p-2 rounded">
                            <strong>Logic:</strong> IF (Down > 10%) THEN Increase Bet Size by 50%
                        </div>
                    </div>
                    
                    <!-- Value Hunting Template -->
                    <div class="bg-gradient-to-br from-teal-500 to-cyan-600 p-6 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('value_hunting')">
                        <div class="text-4xl mb-4">🎯</div>
                        <h4 class="text-xl font-bold mb-2">Value Hunter</h4>
                        <p class="text-sm opacity-90 mb-4">Finds undervalued odds across multiple sportsbooks for maximum profit.</p>
                        <div class="text-xs bg-black bg-opacity-30 p-2 rounded">
                            <strong>Logic:</strong> IF (Best Odds > Market Average + 5%) THEN Place Bet
                        </div>
                    </div>
                    
                    <!-- Arbitrage Template -->
                    <div class="bg-gradient-to-br from-indigo-500 to-purple-600 p-6 rounded-lg text-white cursor-pointer hover:scale-105 transition-transform" onclick="createFromTemplate('arbitrage')">
                        <div class="text-4xl mb-4">⚖️</div>
                        <h4 class="text-xl font-bold mb-2">Arbitrage</h4>
                        <p class="text-sm opacity-90 mb-4">Risk-free profit by betting both sides across different sportsbooks.</p>
                        <div class="text-xs bg-black bg-opacity-30 p-2 rounded">
                            <strong>Logic:</strong> IF (Arbitrage Opportunity > 1%) THEN Place Both Bets
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center">
                    <button onclick="closeModal('strategy-templates-modal')" class="post9-btn px-6 py-2">Close</button>
                </div>
            </div>
        </div>
        
        <!-- Add Strategy Modal -->
        <div id="add-strategy-modal" class="modal">
            <div class="modal-content post9-card">
                <span class="modal-close" onclick="closeModal('add-strategy-modal')">&times;</span>
                <h3 class="text-xl font-bold mb-4 text-white">Add Strategy</h3>
                <form id="add-strategy-form" class="flex flex-col gap-4">
                    <input type="text" name="name" placeholder="Strategy Name" required>
                    <select name="type" required>
                        <option value="basic">Basic</option>
                        <option value="recovery">Recovery</option>
                    </select>
                    <select name="linked_strategy_id" id="linked-strategy-select">
                        <option value="">Link Recovery Strategy (Optional)</option>
                    </select>
                    <input type="text" name="description" placeholder="Description">
                    
                    <!-- Bet Sizing Strategy -->
                    <div class="bg-gray-800 p-4 rounded-lg">
                        <label class="block text-sm font-medium text-gray-300 mb-3">Bet Sizing Strategy</label>
                        <select name="sizing_strategy" id="strategy-sizing-type" onchange="toggleStrategySizingOptions()" class="w-full p-2 border border-gray-600 rounded bg-gray-700 text-white">
                            <option value="kelly-fraction">Kelly Criterion</option>
                            <option value="flat-rate">Flat Rate</option>
                        </select>
                        
                        <!-- Kelly Factor Options -->
                        <div id="strategy-kelly-options" class="mt-3">
                            <label class="block text-sm font-medium text-gray-300 mb-2">Kelly Factor</label>
                            <div class="space-y-2">
                                <div class="flex items-center space-x-3">
                                    <input type="radio" id="strategy-kelly-full" name="kelly_factor" value="1.0" checked class="text-blue-600">
                                    <label for="strategy-kelly-full" class="text-sm text-gray-300">Full Kelly (1.0x)</label>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <input type="radio" id="strategy-kelly-half" name="kelly_factor" value="0.5" class="text-blue-600">
                                    <label for="strategy-kelly-half" class="text-sm text-gray-300">Half Kelly (0.5x)</label>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <input type="radio" id="strategy-kelly-quarter" name="kelly_factor" value="0.25" class="text-blue-600">
                                    <label for="strategy-kelly-quarter" class="text-sm text-gray-300">Quarter Kelly (0.25x)</label>
                                </div>
                                <div class="flex items-center space-x-3">
                                    <input type="radio" id="strategy-kelly-custom" name="kelly_factor" value="custom" class="text-blue-600">
                                    <label for="strategy-kelly-custom" class="text-sm text-gray-300">Custom:</label>
                                    <input type="number" name="kelly_custom_value" step="0.1" min="0.1" max="2.0" value="0.75" 
                                           class="w-20 p-1 border border-gray-600 rounded bg-gray-700 text-white text-sm">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Flat Rate Options -->
                        <div id="strategy-flat-options" class="mt-3 hidden">
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-1">Fixed Amount ($)</label>
                                    <input type="number" name="flat_amount" min="1" value="50" 
                                           class="w-full p-2 border border-gray-600 rounded bg-gray-700 text-white">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-300 mb-1">Fixed Percentage (%)</label>
                                    <input type="number" name="flat_percentage" min="0.1" max="10" step="0.1" value="2.0" 
                                           class="w-full p-2 border border-gray-600 rounded bg-gray-700 text-white">
                                </div>
                            </div>
                            <p class="text-xs text-gray-400 mt-2">Will use the smaller of the two amounts</p>
                        </div>
                    </div>
                    
                    <button type="submit" class="post9-btn p-3 mt-2">Add Strategy</button>
                </form>
            </div>
        </div>
        <div id="investments-page" class="mt-8 post9-card rounded-lg shadow-lg p-6 relative" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">Available Investments</h2>
                <div class="flex items-center gap-4">
                    <button id="cart-toggle-btn" class="post9-btn px-4 py-2 relative" onclick="toggleBetCart()">
                        <span class="inline-block mr-2">🛒</span>Bet Cart
                        <span id="cart-count-badge" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full text-xs px-2 py-1 hidden">0</span>
                    </button>
                </div>
            </div>
            <div id="sport-tabs-container" class="mb-6"></div>
            <div id="cache-indicator" class="w-3 h-3 rounded-full bg-blue-500 inline-block mr-2"></div>
            <span id="cache-text" class="text-sm text-gray-300"></span>
            <div id="investments-container" class="mt-6"></div>
            <div id="no-investments-message" class="text-center text-gray-400 mt-8 hidden">No investments available.</div>
            <button id="refresh-investments-btn" class="post9-btn px-4 py-2 mt-6"><span id="refresh-icon" class="inline-block mr-2">🔄</span>Refresh Investments</button>
            
            <!-- Bet Cart Sidebar -->
            <div id="bet-cart-sidebar" class="fixed right-0 top-0 h-full w-96 bg-white shadow-2xl transform translate-x-full transition-transform duration-300 z-50 overflow-hidden">
                <div class="h-full flex flex-col">
                    <div class="p-4 border-b bg-gray-50">
                        <div class="flex justify-between items-center">
                            <h3 class="text-xl font-bold text-gray-900">Bet Cart</h3>
                            <button onclick="closeBetCart()" class="text-gray-500 hover:text-gray-700">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                        <p class="text-sm text-gray-600 mt-1">Selected: <span id="cart-items-count">0</span> bets</p>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto p-4">
                        <div id="cart-items-container" class="space-y-3">
                            <div id="empty-cart-message" class="text-center text-gray-500 mt-8">
                                <p class="text-lg">🛒</p>
                                <p>No bets selected</p>
                                <p class="text-sm">Add bets from the investment options</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="border-t bg-gray-50 p-4">
                        <div class="mb-3">
                            <div class="text-sm text-gray-600">Total Potential Payout:</div>
                            <div id="cart-total-payout" class="text-xl font-bold text-green-600">$0.00</div>
                        </div>
                        <div class="space-y-2">
                            <button id="place-bets-btn" onclick="showBetConfirmation()" class="w-full post9-btn py-3" disabled>
                                Place Selected Bets
                            </button>
                            <button id="export-excel-btn" onclick="exportToExcel()" class="w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50" disabled>
                                Export to Excel
                            </button>
                            <button onclick="clearCart()" class="w-full bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600">
                                Clear Cart
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Cart Overlay -->
            <div id="cart-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden" onclick="closeBetCart()"></div>
        </div>
        <div id="account-page" class="mt-8 post9-card rounded-lg shadow-lg p-6" style="display: none;">
            <h2 class="text-2xl font-bold mb-6 text-white">Account</h2>
            <div id="api-status-section" class="mb-6 post9-card p-4">
                <h3 class="text-lg font-bold text-white mb-2">API Usage</h3>
                <div class="flex flex-col gap-2">
                    <div class="flex items-center gap-2">
                        <span class="stats-label">Requests Remaining:</span>
                        <span id="api-requests-remaining" class="stats-value">-</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span class="stats-label">Requests Used:</span>
                        <span id="api-requests-used" class="stats-value">-</span>
                    </div>
                </div>
            </div>
            <div id="auth-section" class="mb-8">
                <form id="signin-form-element" class="flex flex-col gap-4 mb-4 post9-card p-4">
                    <input type="email" name="email" placeholder="Email" required>
                    <input type="password" name="password" placeholder="Password" required>
                    <button type="submit" class="post9-btn p-3">Sign In</button>
                </form>
                <form id="signup-form-element" class="flex flex-col gap-4 mb-4 post9-card p-4" style="display:none;">
                    <input type="email" name="email" placeholder="Email" required>
                    <input type="password" name="password" placeholder="Password" required>
                    <input type="password" name="confirmPassword" placeholder="Confirm Password" required>
                    <button type="submit" class="post9-btn p-3">Sign Up</button>
                </form>
                <button id="demo-signin-btn" class="post9-btn p-3">Demo Sign In</button>
            </div>
            <div id="account-management-section" class="mb-8 hidden post9-card p-4">
                <div class="mb-4">
                    <span class="text-lg font-bold text-white">Welcome, <span id="user-email-display">Demo Mode</span></span>
                </div>
                <form id="profile-form" class="flex flex-col gap-4 mb-4">
                    <input type="email" id="profile-email" name="email" placeholder="Email">
                    <input type="text" id="profile-display-name" name="displayName" placeholder="Display Name">
                    <button type="submit" class="post9-btn p-3">Update Profile</button>
                </form>
                <form id="password-form" class="flex flex-col gap-4 mb-4">
                    <input type="password" name="currentPassword" placeholder="Current Password">
                    <input type="password" name="newPassword" placeholder="New Password">
                    <input type="password" name="confirmNewPassword" placeholder="Confirm New Password">
                    <button type="submit" class="post9-btn p-3">Change Password</button>
                </form>
                <button id="logout-btn" class="post9-btn p-3 mb-2">Sign Out</button>
                <button id="delete-account-btn" class="post9-btn p-3 bg-red-600 text-white">Delete Account</button>
            </div>
        </div>

        <!-- Admin/System Status Page -->
        <div id="admin-page" class="mt-8 post9-card rounded-lg shadow-lg p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">System Status & Feature Overview</h2>
                <button onclick="refreshSystemStatus()" class="post9-btn px-4 py-2">🔄 Refresh Status</button>
            </div>
            
            <div id="system-status-loading" class="text-center py-8">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-white"></div>
                <p class="text-white mt-2">Loading system status...</p>
            </div>
            
            <div id="system-status-content" style="display: none;">
                <!-- Overall Status Summary -->
                <div class="bg-gray-800 rounded-lg p-6 mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="text-center">
                            <div id="overall-mode-indicator" class="w-16 h-16 rounded-full mx-auto mb-2 flex items-center justify-center text-2xl font-bold"></div>
                            <h3 class="text-lg font-semibold text-white">Overall Mode</h3>
                            <p id="overall-mode-text" class="text-gray-300"></p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 rounded-full bg-green-500 mx-auto mb-2 flex items-center justify-center text-white text-2xl font-bold">
                                <span id="production-count">0</span>
                            </div>
                            <h3 class="text-lg font-semibold text-white">Production Features</h3>
                            <p class="text-gray-300">Fully functional</p>
                        </div>
                        <div class="text-center">
                            <div class="w-16 h-16 rounded-full bg-yellow-500 mx-auto mb-2 flex items-center justify-center text-white text-2xl font-bold">
                                <span id="demo-count">0</span>
                            </div>
                            <h3 class="text-lg font-semibold text-white">Demo Features</h3>
                            <p class="text-gray-300">Mock/testing data</p>
                        </div>
                    </div>
                </div>

                <!-- Feature Status Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                    <div id="features-container">
                        <!-- Feature cards will be dynamically populated -->
                    </div>
                </div>

                <!-- System Warnings -->
                <div id="warnings-container" class="bg-yellow-900 bg-opacity-20 border border-yellow-500 rounded-lg p-4" style="display: none;">
                    <h3 class="text-lg font-semibold text-yellow-400 mb-2">⚠️ System Warnings</h3>
                    <ul id="warnings-list" class="text-yellow-300 space-y-1">
                        <!-- Warnings will be dynamically populated -->
                    </ul>
                </div>

                <!-- Last Updated -->
                <div class="text-center text-gray-400 text-sm mt-6">
                    Last updated: <span id="status-timestamp">--</span>
                </div>
            </div>
        </div>

        <!-- Strategy Builder Page -->
        <div id="strategy-builder-page" class="mt-8 post9-card rounded-lg shadow-lg p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">Visual Strategy Builder</h2>
                <div class="flex gap-3">
                    <button onclick="showModal('strategy-templates-modal')" class="post9-btn px-4 py-2">📋 Templates</button>
                    <button onclick="saveCurrentStrategy()" class="post9-btn px-4 py-2">💾 Save Strategy</button>
                    <button onclick="showStrategyBuilderHelp()" class="post9-btn px-4 py-2">❓ Help</button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-96">
                <!-- Component Palette -->
                <div class="bg-gray-100 rounded-lg p-4 overflow-y-auto">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">Components</h3>
                    
                    <div class="mb-4">
                        <h4 class="font-medium text-gray-800 mb-2">Logic Blocks</h4>
                        <div class="space-y-2">
                            <div class="draggable-component bg-blue-200 border-2 border-blue-400 p-3 rounded-lg cursor-pointer text-blue-900 font-semibold hover:bg-blue-300 transition-colors" data-type="if-condition">
                                📋 IF/THEN
                            </div>
                            <div class="draggable-component bg-blue-200 border-2 border-blue-400 p-3 rounded-lg cursor-pointer text-blue-900 font-semibold hover:bg-blue-300 transition-colors" data-type="and-or">
                                🔗 AND/OR
                            </div>
                            <div class="draggable-component bg-blue-200 border-2 border-blue-400 p-3 rounded-lg cursor-pointer text-blue-900 font-semibold hover:bg-blue-300 transition-colors" data-type="comparison">
                                ⚖️ Compare
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <h4 class="font-medium text-gray-800 mb-2">Data Sources</h4>
                        <div class="space-y-2">
                            <div class="draggable-component bg-green-200 border-2 border-green-400 p-3 rounded-lg cursor-pointer text-green-900 font-semibold hover:bg-green-300 transition-colors" data-type="weather">
                                🌤️ Weather
                            </div>
                            <div class="draggable-component bg-green-200 border-2 border-green-400 p-3 rounded-lg cursor-pointer text-green-900 font-semibold hover:bg-green-300 transition-colors" data-type="team-stats">
                                📊 Team Stats
                            </div>
                            <div class="draggable-component bg-green-200 border-2 border-green-400 p-3 rounded-lg cursor-pointer text-green-900 font-semibold hover:bg-green-300 transition-colors" data-type="model-prediction">
                                🤖 ML Model
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <h4 class="font-medium text-gray-800 mb-2">Actions</h4>
                        <div class="space-y-2">
                            <div class="draggable-component bg-amber-200 border-2 border-amber-400 p-3 rounded-lg cursor-pointer text-amber-900 font-semibold hover:bg-amber-300 transition-colors" data-type="place-bet">
                                💰 Place Bet
                            </div>
                            <div class="draggable-component bg-amber-200 border-2 border-amber-400 p-3 rounded-lg cursor-pointer text-amber-900 font-semibold hover:bg-amber-300 transition-colors" data-type="skip-bet">
                                ⏭️ Skip Bet
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Visual Flow Canvas -->
                <div class="lg:col-span-2 bg-white rounded-lg p-4 border-2 border-dashed border-gray-300 relative">
                    <!-- Canvas Controls -->
                    <div class="absolute top-2 right-2 flex gap-2 z-10">
                        <button onclick="clearCanvas()" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm font-medium transition-colors">
                            🗑️ Clear
                        </button>
                        <button onclick="undoLastAction()" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm font-medium transition-colors">
                            ↶ Undo
                        </button>
                    </div>
                    
                    <div id="strategy-canvas" class="w-full h-full min-h-96">
                        <div class="absolute inset-0 flex items-center justify-center text-gray-500" id="canvas-placeholder">
                            <div class="text-center">
                                <div class="text-4xl mb-2">🎯</div>
                                <p>Drag components here to build your strategy</p>
                                <p class="text-sm mt-1">Start with an IF/THEN block</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Parameters Panel -->
                <div class="bg-gray-100 rounded-lg p-4 overflow-y-auto">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">Parameters</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Risk Level</label>
                            <input type="range" id="risk-level" min="1" max="10" value="5" class="w-full">
                            <div class="flex justify-between text-xs text-gray-500">
                                <span>Conservative</span>
                                <span id="risk-level-value">5</span>
                                <span>Aggressive</span>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Bet Size %</label>
                            <input type="range" id="bet-size-percent" min="0.5" max="10" step="0.1" value="2.5" class="w-full">
                            <div class="text-center text-sm text-gray-700">
                                <span id="bet-size-value">2.5</span>% of balance
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Max Bets/Week</label>
                            <input type="number" id="max-bets-week" min="1" max="50" value="5" class="w-full p-2 border border-gray-300 rounded">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Recovery Strategy</label>
                            <select id="recovery-strategy" class="w-full p-2 border border-gray-300 rounded">
                                <option value="none">None</option>
                                <option value="martingale">Martingale</option>
                                <option value="fibonacci">Fibonacci</option>
                                <option value="kelly">Kelly Criterion</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <button onclick="testStrategy()" class="w-full post9-btn mb-2">🧪 Test Strategy</button>
                        <button onclick="simulateStrategy()" class="w-full post9-btn">📈 Backtest</button>
                    </div>
                </div>
            </div>
            
            <!-- Strategy Output Preview -->
            <div class="mt-6 bg-gray-800 text-green-400 p-4 rounded-lg">
                <h4 class="text-lg font-semibold mb-2">Strategy Logic (Plain English)</h4>
                <div id="strategy-description" class="font-mono text-sm">
                    Build your strategy above to see the logic description here...
                </div>
            </div>
        </div>

        <!-- Model Gallery Page -->
        <div id="model-gallery-page" class="mt-8 post9-card rounded-lg shadow-lg p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">Model Gallery</h2>
                <div class="flex gap-3">
                    <button onclick="showModal('train-custom-model-modal')" class="post9-btn px-4 py-2">Train Custom Model</button>
                    <button onclick="showModal('model-comparison-modal')" class="post9-btn px-4 py-2">Compare Models</button>
                </div>
            </div>
            
            <!-- Model Filters -->
            <div class="bg-gray-100 p-4 rounded-lg mb-6">
                <div class="flex flex-wrap gap-4 items-center">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Sport</label>
                        <select id="model-filter-sport" class="p-2 border border-gray-300 rounded">
                            <option value="all">All Sports</option>
                            <option value="nfl">NFL</option>
                            <option value="nba">NBA</option>
                            <option value="mlb">MLB</option>
                            <option value="ncaaf">NCAAF</option>
                            <option value="ncaab">NCAAB</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Model Type</label>
                        <select id="model-filter-type" class="p-2 border border-gray-300 rounded">
                            <option value="all">All Types</option>
                            <option value="lstm">LSTM</option>
                            <option value="transformer">Transformer</option>
                            <option value="random_forest">Random Forest</option>
                            <option value="xgboost">XGBoost</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Performance</label>
                        <select id="model-filter-performance" class="p-2 border border-gray-300 rounded">
                            <option value="all">All Performance</option>
                            <option value="high">High (>70%)</option>
                            <option value="medium">Medium (60-70%)</option>
                            <option value="low">Low (<60%)</option>
                        </select>
                    </div>
                    <button onclick="filterModels()" class="post9-btn px-4 py-2 mt-6">Apply Filters</button>
                </div>
            </div>
            
            <!-- Model Grid -->
            <div id="models-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Models will be populated here -->
            </div>
        </div>

        <!-- Training Queue Page -->
        <div id="training-queue-page" class="mt-8 post9-card rounded-lg shadow-lg p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">🔥 Training Queue & GPU Resources</h2>
                <div class="flex gap-3">
                    <button onclick="refreshTrainingQueue()" class="post9-btn px-4 py-2">🔄 Refresh</button>
                    <button onclick="showModal('submit-training-modal')" class="post9-btn px-4 py-2">🚀 Submit Training Job</button>
                </div>
            </div>

            <!-- GPU Resource Status -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                <div class="bg-gradient-to-br from-green-500 to-green-700 p-4 rounded-lg text-white">
                    <div class="text-2xl font-bold" id="available-gpus">2</div>
                    <div class="text-sm opacity-90">Available GPUs</div>
                    <div class="text-xs opacity-75">Ready for training</div>
                </div>
                <div class="bg-gradient-to-br from-blue-500 to-blue-700 p-4 rounded-lg text-white">
                    <div class="text-2xl font-bold" id="gpu-utilization">85%</div>
                    <div class="text-sm opacity-90">GPU Utilization</div>
                    <div class="text-xs opacity-75">Average across all GPUs</div>
                </div>
                <div class="bg-gradient-to-br from-orange-500 to-orange-700 p-4 rounded-lg text-white">
                    <div class="text-2xl font-bold" id="active-training-jobs">3</div>
                    <div class="text-sm opacity-90">Active Jobs</div>
                    <div class="text-xs opacity-75">Currently training</div>
                </div>
                <div class="bg-gradient-to-br from-purple-500 to-purple-700 p-4 rounded-lg text-white">
                    <div class="text-2xl font-bold" id="queued-jobs">5</div>
                    <div class="text-sm opacity-90">Queued Jobs</div>
                    <div class="text-xs opacity-75">Waiting to start</div>
                </div>
            </div>

            <!-- Training Queue Tabs -->
            <div class="mb-6">
                <nav class="flex space-x-1 bg-gray-800 rounded-lg p-1">
                    <button onclick="showTrainingTab('active')" id="active-tab" class="training-tab-btn active">Active Jobs</button>
                    <button onclick="showTrainingTab('queued')" id="queued-tab" class="training-tab-btn">Queue</button>
                    <button onclick="showTrainingTab('completed')" id="completed-tab" class="training-tab-btn">Completed</button>
                    <button onclick="showTrainingTab('gpu-stats')" id="gpu-stats-tab" class="training-tab-btn">GPU Stats</button>
                </nav>
            </div>

            <!-- Active Training Jobs -->
            <div id="active-training-tab" class="training-tab-content">
                <div class="space-y-4" id="active-jobs-container">
                    <!-- Active jobs will be populated here -->
                </div>
            </div>

            <!-- Queued Jobs -->
            <div id="queued-training-tab" class="training-tab-content" style="display: none;">
                <div class="space-y-4" id="queued-jobs-container">
                    <!-- Queued jobs will be populated here -->
                </div>
            </div>

            <!-- Completed Jobs -->
            <div id="completed-training-tab" class="training-tab-content" style="display: none;">
                <div class="space-y-4" id="completed-jobs-container">
                    <!-- Completed jobs will be populated here -->
                </div>
            </div>

            <!-- GPU Statistics -->
            <div id="gpu-stats-training-tab" class="training-tab-content" style="display: none;">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="gpu-stats-container">
                    <!-- GPU stats will be populated here -->
                </div>
            </div>
        </div>

        <!-- Advanced Analytics Page -->
        <div id="analytics-page" class="mt-8 post9-card rounded-lg shadow-lg p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">Advanced Analytics</h2>
                <div class="flex gap-3">
                    <button onclick="exportAnalytics()" class="post9-btn px-4 py-2">📊 Export Report</button>
                    <button onclick="showModal('settings-modal')" class="post9-btn px-4 py-2">⚙️ Settings</button>
                </div>
            </div>
            
            <!-- Summary Metrics -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                <div class="bg-green-100 p-4 rounded-lg">
                    <div class="text-2xl font-bold text-green-800" id="analytics-total-profit">+$1,247</div>
                    <div class="text-sm text-green-600">Total Profit (30d)</div>
                    <div class="text-xs text-green-500">▲ +5.2% vs last month</div>
                </div>
                <div class="bg-blue-100 p-4 rounded-lg">
                    <div class="text-2xl font-bold text-blue-800" id="analytics-win-rate">68.4%</div>
                    <div class="text-sm text-blue-600">Win Rate</div>
                    <div class="text-xs text-blue-500">▲ +2.1% vs last month</div>
                </div>
                <div class="bg-purple-100 p-4 rounded-lg">
                    <div class="text-2xl font-bold text-purple-800" id="analytics-roi">+12.3%</div>
                    <div class="text-sm text-purple-600">ROI</div>
                    <div class="text-xs text-purple-500">▲ +1.8% vs last month</div>
                </div>
                <div class="bg-orange-100 p-4 rounded-lg">
                    <div class="text-2xl font-bold text-orange-800" id="analytics-bets-count">89</div>
                    <div class="text-sm text-orange-600">Total Bets</div>
                    <div class="text-xs text-orange-500">▲ +12 vs last month</div>
                </div>
            </div>
            
            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Profit Over Time Chart -->
                <div class="bg-white p-4 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">Profit Over Time</h3>
                    <div id="profit-over-time-chart" class="h-64 flex items-center justify-center text-gray-500">
                        Chart will be rendered here
                    </div>
                </div>
                
                <!-- Strategy Performance Chart -->
                <div class="bg-white p-4 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">Strategy Performance</h3>
                    <div id="strategy-performance-chart" class="h-64 flex items-center justify-center text-gray-500">
                        Chart will be rendered here
                    </div>
                </div>
            </div>
            
            <!-- Heatmap and Alerts -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Performance Heatmap -->
                <div class="bg-white p-4 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">Performance Heatmap</h3>
                    <div id="performance-heatmap" class="h-64">
                        <div class="text-sm text-gray-600 mb-2">Profit by Day & Time</div>
                        <div class="grid grid-cols-7 gap-1 text-xs">
                            <!-- Heatmap grid will be rendered here -->
                            <div class="text-center font-medium">Mon</div>
                            <div class="text-center font-medium">Tue</div>
                            <div class="text-center font-medium">Wed</div>
                            <div class="text-center font-medium">Thu</div>
                            <div class="text-center font-medium">Fri</div>
                            <div class="text-center font-medium">Sat</div>
                            <div class="text-center font-medium">Sun</div>
                        </div>
                    </div>
                </div>
                
                <!-- Recent Alerts -->
                <div class="bg-white p-4 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">Recent Alerts</h3>
                    <div id="recent-alerts" class="space-y-3">
                        <div class="flex items-center p-2 bg-yellow-50 border border-yellow-200 rounded">
                            <span class="text-yellow-600 mr-2">🟡</span>
                            <div>
                                <div class="font-medium text-yellow-800">NFL Model Performance Drop</div>
                                <div class="text-xs text-yellow-600">2 hours ago</div>
                            </div>
                        </div>
                        <div class="flex items-center p-2 bg-red-50 border border-red-200 rounded">
                            <span class="text-red-600 mr-2">🔴</span>
                            <div>
                                <div class="font-medium text-red-800">Losing Streak Detected (5 bets)</div>
                                <div class="text-xs text-red-600">4 hours ago</div>
                            </div>
                        </div>
                        <div class="flex items-center p-2 bg-green-50 border border-green-200 rounded">
                            <span class="text-green-600 mr-2">🟢</span>
                            <div>
                                <div class="font-medium text-green-800">High Value Bet Found</div>
                                <div class="text-xs text-green-600">Lakers vs Warriors - 12 mins ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Predictive Analytics Page (formerly ML Dashboard) -->
        <div id="predictive-analytics-page" class="mt-8 post9-card rounded-lg shadow-lg p-6" style="display: none;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white">🔮 Predictive Analytics</h2>
                <div class="flex gap-3">
                    <button onclick="refreshPredictiveModels()" class="post9-btn px-4 py-2">🔄 Refresh Models</button>
                    <button onclick="showModal('train-model-modal')" class="post9-btn px-4 py-2">🏋️ Train Model</button>
                </div>
            </div>

            <!-- Predictive Analytics Tabs -->
            <div class="mb-6">
                <nav class="flex space-x-1 bg-gray-800 rounded-lg p-1">
                    <button onclick="showPredictiveTab('models')" id="models-tab" class="predictive-tab-btn active">Models</button>
                    <button onclick="showPredictiveTab('predictions')" id="predictions-tab" class="predictive-tab-btn">Predictions</button>
                    <button onclick="showPredictiveTab('training')" id="training-tab" class="predictive-tab-btn">Training</button>
                    <button onclick="showPredictiveTab('optimizer')" id="optimizer-tab" class="predictive-tab-btn">
                        <span class="tooltip">Kelly Optimizer
                            <span class="tooltiptext">
                                <strong>Kelly Criterion:</strong> A mathematical formula for determining optimal bet sizes to maximize long-term portfolio growth while minimizing risk of ruin.
                            </span>
                        </span>
                    </button>
                </nav>
            </div>

            <!-- Models Tab -->
            <div id="models-tab-content" class="predictive-tab-content">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Model Status Cards -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold text-gray-800">Active Models</h3>
                            <span class="text-2xl">🤖</span>
                        </div>
                        <div class="text-2xl font-bold text-blue-600" id="active-models-count">3</div>
                        <div class="text-sm text-gray-600">Running</div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold text-gray-800">Avg Accuracy</h3>
                            <span class="text-2xl">🎯</span>
                        </div>
                        <div class="text-2xl font-bold text-green-600" id="avg-accuracy">68.2%</div>
                        <div class="text-sm text-gray-600">Last 30 days</div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold text-gray-800">Predictions</h3>
                            <span class="text-2xl">📊</span>
                        </div>
                        <div class="text-2xl font-bold text-purple-600" id="predictions-count">156</div>
                        <div class="text-sm text-gray-600">This month</div>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold text-gray-800">Profit</h3>
                            <span class="text-2xl">💰</span>
                        </div>
                        <div class="text-2xl font-bold text-green-600" id="model-profit">+$1,234</div>
                        <div class="text-sm text-gray-600">From predictions</div>
                    </div>
                </div>

                <!-- Model Gallery -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Model Gallery</h3>
                    <div id="predictive-models-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Models will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Predictions Tab -->
            <div id="predictions-tab-content" class="predictive-tab-content hidden">
                <div class="bg-white p-6 rounded-lg shadow mb-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">🔮 Game Prediction Tool</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Sport</label>
                            <select id="pred-sport" class="w-full p-2 border border-gray-300 rounded">
                                <option value="NBA">NBA</option>
                                <option value="NFL">NFL</option>
                                <option value="MLB">MLB</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Home Team Win %</label>
                            <input type="number" id="pred-home-win-pct" class="w-full p-2 border border-gray-300 rounded" 
                                   min="0" max="100" step="0.1" value="65.5" placeholder="65.5">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Away Team Win %</label>
                            <input type="number" id="pred-away-win-pct" class="w-full p-2 border border-gray-300 rounded" 
                                   min="0" max="100" step="0.1" value="58.2" placeholder="58.2">
                        </div>
                        <div class="flex items-end">
                            <button onclick="makePrediction()" class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition-colors">
                                Generate Prediction
                            </button>
                        </div>
                    </div>
                    
                    <div id="prediction-results" class="hidden mt-4 p-4 bg-gray-50 rounded-lg">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="text-center">
                                <div class="text-sm font-semibold text-gray-600">Predicted Outcome</div>
                                <div id="predicted-outcome" class="text-lg font-bold text-blue-600">-</div>
                                <div id="confidence-level" class="text-sm text-gray-500">-</div>
                            </div>
                            <div class="text-center">
                                <div class="text-sm font-semibold text-gray-600">
                                    <span class="tooltip">Kelly Bet Size
                                        <span class="tooltiptext">
                                            <strong>Kelly Criterion:</strong> A mathematical formula used to determine the optimal bet size. It calculates the percentage of your bankroll to wager based on the probability of winning and the odds offered. The Kelly formula maximizes long-term growth while minimizing the risk of ruin.
                                        </span>
                                    </span>
                                </div>
                                <div id="kelly-bet-size" class="text-lg font-bold text-green-600">-</div>
                                <div class="text-sm text-gray-500">Recommended</div>
                            </div>
                            <div class="text-center">
                                <div class="text-sm font-semibold text-gray-600">Expected ROI</div>
                                <div id="expected-roi" class="text-lg font-bold text-purple-600">-</div>
                                <div class="text-sm text-gray-500">Projected</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Predictions -->
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Recent Predictions</h3>
                    <div id="recent-predictions" class="space-y-3">
                        <!-- Recent predictions will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Training Tab -->
            <div id="training-tab-content" class="predictive-tab-content hidden">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Model Training</h3>
                    <p class="text-gray-600 mb-4">Configure and train new predictive models for sports betting analysis.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Sport</label>
                            <select id="train-sport" class="w-full p-2 border border-gray-300 rounded">
                                <option value="NBA">NBA</option>
                                <option value="NFL">NFL</option>
                                <option value="MLB">MLB</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Model Type</label>
                            <select id="train-model-type" class="w-full p-2 border border-gray-300 rounded">
                                <option value="statistical">Statistical</option>
                                <option value="neural">Neural Network</option>
                                <option value="ensemble">Ensemble</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <button onclick="startModelTraining()" class="bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 transition-colors">
                            Start Training
                        </button>
                    </div>
                </div>
            </div>

            <!-- Kelly Optimizer Tab -->
            <div id="optimizer-tab-content" class="predictive-tab-content hidden">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Kelly Criterion Optimizer</h3>
                    <p class="text-gray-600 mb-4">Calculate optimal bet sizes using the Kelly Criterion for risk management with advanced scaling options.</p>
                    
                    <!-- Basic Kelly Inputs -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Win Probability (%)</label>
                            <input type="number" id="kelly-win-prob" class="w-full p-2 border border-gray-300 rounded" 
                                   min="0" max="100" step="0.1" value="55.0">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Odds (Decimal)</label>
                            <input type="number" id="kelly-odds" class="w-full p-2 border border-gray-300 rounded" 
                                   min="1" step="0.01" value="2.00">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Bankroll ($)</label>
                            <input type="number" id="kelly-bankroll" class="w-full p-2 border border-gray-300 rounded" 
                                   min="1" value="1000">
                        </div>
                    </div>
                    
                    <!-- Kelly Factor & Betting Strategy -->
                    <div class="border-t pt-6 mb-6">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">Betting Strategy</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Strategy Type -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Strategy Type</label>
                                <select id="kelly-strategy-type" class="w-full p-2 border border-gray-300 rounded">
                                    <option value="kelly-fraction">Kelly Fraction</option>
                                    <option value="flat-rate">Flat Rate</option>
                                </select>
                            </div>
                            
                            <!-- Kelly Fraction Options -->
                            <div id="kelly-fraction-options">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Kelly Factor</label>
                                <div class="space-y-2">
                                    <div class="flex items-center space-x-3">
                                        <input type="radio" id="kelly-full" name="kelly-factor" value="1.0" checked class="text-blue-600">
                                        <label for="kelly-full" class="text-sm">Full Kelly (1.0x)</label>
                                    </div>
                                    <div class="flex items-center space-x-3">
                                        <input type="radio" id="kelly-half" name="kelly-factor" value="0.5" class="text-blue-600">
                                        <label for="kelly-half" class="text-sm">Half Kelly (0.5x)</label>
                                    </div>
                                    <div class="flex items-center space-x-3">
                                        <input type="radio" id="kelly-quarter" name="kelly-factor" value="0.25" class="text-blue-600">
                                        <label for="kelly-quarter" class="text-sm">Quarter Kelly (0.25x)</label>
                                    </div>
                                    <div class="flex items-center space-x-3">
                                        <input type="radio" id="kelly-custom" name="kelly-factor" value="custom" class="text-blue-600">
                                        <label for="kelly-custom" class="text-sm">Custom:</label>
                                        <input type="number" id="kelly-custom-value" step="0.1" min="0.1" max="2.0" value="0.75" 
                                               class="w-20 p-1 border border-gray-300 rounded text-sm">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Flat Rate Options -->
                            <div id="flat-rate-options" class="hidden">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Flat Rate Amount</label>
                                <div class="space-y-3">
                                    <div>
                                        <label class="block text-xs text-gray-600 mb-1">Fixed Dollar Amount</label>
                                        <input type="number" id="flat-amount" min="1" value="50" 
                                               class="w-full p-2 border border-gray-300 rounded">
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-600 mb-1">OR Fixed Percentage of Bankroll</label>
                                        <div class="flex items-center space-x-2">
                                            <input type="number" id="flat-percentage" min="0.1" max="100" step="0.1" value="2.0" 
                                                   class="w-20 p-2 border border-gray-300 rounded">
                                            <span class="text-sm text-gray-600">%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex gap-3">
                        <button onclick="calculateKellyOptimal()" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 transition-colors">
                            Calculate Optimal Bet
                        </button>
                        <button onclick="resetKellyCalculator()" class="bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600 transition-colors">
                            Reset
                        </button>
                    </div>
                    
                    <div id="kelly-results" class="mt-6 hidden p-4 bg-gray-50 rounded-lg">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div class="text-center">
                                <div class="text-sm font-semibold text-gray-600">Full Kelly Bet</div>
                                <div id="kelly-full-amount" class="text-lg font-bold text-gray-800">-</div>
                            </div>
                            <div class="text-center">
                                <div class="text-sm font-semibold text-gray-600">Recommended Bet</div>
                                <div id="kelly-bet-amount" class="text-xl font-bold text-green-600">-</div>
                            </div>
                            <div class="text-center">
                                <div class="text-sm font-semibold text-gray-600">% of Bankroll</div>
                                <div id="kelly-percentage" class="text-xl font-bold text-blue-600">-</div>
                            </div>
                            <div class="text-center">
                                <div class="text-sm font-semibold text-gray-600">Expected Growth</div>
                                <div id="kelly-growth" class="text-xl font-bold text-purple-600">-</div>
                            </div>
                        </div>
                        <div id="kelly-strategy-info" class="mt-4 p-3 bg-blue-50 rounded text-sm text-blue-800">
                            <!-- Strategy explanation will be shown here -->
                        </div>
                    </div>
                </div>
                
                <!-- Risk Metrics Section -->
                <div class="bg-white p-6 rounded-lg shadow mt-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">🎯 Risk Metrics</h3>
                    <p class="text-gray-600 mb-4">Key performance and risk indicators for your portfolio.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                <span class="font-semibold">
                                    <span class="tooltip">Sharpe Ratio
                                        <span class="tooltiptext">
                                            <strong>Sharpe Ratio:</strong> Measures risk-adjusted returns by calculating excess return per unit of risk. A higher ratio indicates better risk-adjusted performance. Values above 1.0 are considered good, above 2.0 are excellent.
                                        </span>
                                    </span>:
                                </span>
                                <span class="text-green-600 font-bold">1.45</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                <span class="font-semibold">
                                    <span class="tooltip">Sortino Ratio
                                        <span class="tooltiptext">
                                            <strong>Sortino Ratio:</strong> Similar to Sharpe Ratio but only considers downside volatility (negative returns) instead of total volatility. This provides a better measure of risk-adjusted returns by focusing on harmful volatility. Higher values indicate better downside-protected performance.
                                        </span>
                                    </span>:
                                </span>
                                <span class="text-green-600 font-bold">1.82</span>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                <span class="font-semibold">
                                    <span class="tooltip">Max Drawdown
                                        <span class="tooltiptext">
                                            <strong>Maximum Drawdown:</strong> The largest peak-to-trough decline in portfolio value. It measures the worst-case scenario loss from a previous high. Lower values indicate better downside protection and risk management.
                                        </span>
                                    </span>:
                                </span>
                                <span class="text-red-600 font-bold">-8.4%</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                <span class="font-semibold">Win Rate:</span>
                                <span class="text-blue-600 font-bold">65.2%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="bot-details-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="window.closeModal('bot-details-modal')">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Edit Investor: <span id="modal-bot-name"></span></h2>
            <form id="edit-bot-form" class="space-y-4">
                <input type="hidden" id="modal-bot-id">
                <div>
                    <label for="modal-name" class="block text-sm font-medium text-gray-700">Name</label>
                    <input type="text" id="modal-name" name="name" class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label for="modal-strategy" class="block text-sm font-medium text-gray-700">Strategy</label>
                    <select id="modal-strategy" name="strategy_id" class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        </select>
                </div>
                <div>
                    <label for="modal-balance" class="block text-sm font-medium text-gray-700">Current Balance</label>
                    <input type="number" step="0.01" id="modal-balance" name="current_balance" class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" disabled>
                </div>
                <div>
                    <label for="modal-bet-percent" class="block text-sm font-medium text-gray-700">Max Bet % of Balance</label>
                    <input type="number" step="0.01" id="modal-bet-percent" name="bet_percentage" class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label for="modal-max-bets" class="block text-sm font-medium text-gray-700">Max Bets / Week</label>
                    <input type="number" id="modal-max-bets" name="max_bets_per_week" class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label for="modal-min-confidence" class="block text-sm font-medium text-gray-700">Minimum Confidence %</label>
                    <input type="number" id="modal-min-confidence" name="minimum_confidence" min="50" max="95" class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label for="modal-kelly-fraction" class="block text-sm font-medium text-gray-700">Kelly Fraction (0.1-1.0)</label>
                    <input type="number" id="modal-kelly-fraction" name="kelly_fraction" min="0.1" max="1.0" step="0.05" class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label for="modal-schema-version" class="block text-sm font-medium text-gray-700">Schema Version</label>
                    <input type="text" id="modal-schema-version" name="schema_version" class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm bg-gray-100" readonly>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Allowable Platforms</label>
                    <div class="mt-1 space-y-2">
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" id="modal-platform-draftkings" name="allowable_platforms" value="DraftKings" 
                                   class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                            <span class="text-sm text-gray-700">DraftKings</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" id="modal-platform-fanduel" name="allowable_platforms" value="FanDuel" 
                                   class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                            <span class="text-sm text-gray-700">FanDuel</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" id="modal-platform-betmgm" name="allowable_platforms" value="BetMGM" 
                                   class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                            <span class="text-sm text-gray-700">BetMGM</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" id="modal-platform-caesars" name="allowable_platforms" value="Caesars" 
                                   class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                            <span class="text-sm text-gray-700">Caesars</span>
                        </label>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" id="modal-platform-pointsbet" name="allowable_platforms" value="PointsBet" 
                                   class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                            <span class="text-sm text-gray-700">PointsBet</span>
                        </label>
                    </div>
                    <p class="text-xs text-gray-500 mt-2">Select which sportsbooks this bot can consider for placing bets</p>
                </div>
                <button type="submit" class="w-full p-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition duration-300">Save Changes</button>
            </form>
        </div>
    </div>
    
    <div id="strategy-details-modal" class="modal">
        <div class="modal-content max-w-2xl">
            <span class="modal-close" onclick="window.closeModal('strategy-details-modal')">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Edit Strategy: <span id="strategy-modal-name"></span></h2>
            <form id="edit-strategy-form" class="space-y-4">
                <input type="hidden" id="strategy-modal-id">
                <div>
                    <label for="strategy-modal-description" class="block text-sm font-medium text-gray-700">Description</label>
                    <textarea id="strategy-modal-description" name="description" rows="4" class="mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Parameters</label>
                    <div id="strategy-modal-parameters" class="mt-1 space-y-3">
                        </div>
                </div>
                <button type="submit" class="w-full p-3 bg-purple-600 text-white font-semibold rounded-lg hover:bg-purple-700 transition duration-300">Save Changes</button>
            </form>
        </div>
    </div>

    <div id="history-modal" class="modal">
        <div class="modal-content max-w-2xl">
            <span class="modal-close" onclick="window.closeModal('history-modal')">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Bet History for <span id="history-bot-name"></span></h2>
            <div class="overflow-y-auto max-h-96">
                <table class="w-full divide-y divide-gray-200">
                    <thead>
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Teams</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Wager</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Odds</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Payout</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Outcome</th>
                        </tr>
                    </thead>
                    <tbody id="history-table-body" class="bg-white divide-y divide-gray-200">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="bot-log-modal" class="modal">
        <div class="modal-content max-w-2xl">
            <span class="modal-close" onclick="window.closeModal('bot-log-modal')">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Investor Log for <span id="log-bot-name"></span></h2>
            <div class="overflow-y-auto max-h-96 bg-gray-100 p-4 rounded-md text-sm font-mono whitespace-pre-wrap">
                <pre id="bot-log-content"></pre>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content max-w-md">
            <span class="modal-close" onclick="window.closeModal('settings-modal')">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Investment Settings</h2>
            <form id="settings-form" class="space-y-4">
                <div>
                    <label class="flex items-center space-x-3">
                        <input type="checkbox" id="auto-refresh-checkbox" name="auto_refresh_on_login" 
                               class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                        <div class="flex flex-col">
                            <span class="text-sm font-medium text-gray-700">Auto-refresh on login</span>
                            <span class="text-xs text-gray-500">Automatically fetch fresh data when you open the app</span>
                        </div>
                    </label>
                </div>
                <div>
                    <label for="cache-expiry-select" class="block text-sm font-medium text-gray-700 mb-2">Cache expiry time</label>
                    <select id="cache-expiry-select" name="cache_expiry_minutes" 
                            class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        <option value="15">15 minutes</option>
                        <option value="30">30 minutes</option>
                        <option value="60">1 hour</option>
                        <option value="120">2 hours</option>
                        <option value="1440">24 hours</option>
                    </select>
                    <p class="text-xs text-gray-500 mt-1">How long to keep cached data before considering it stale</p>
                </div>
                <div class="bg-gray-50 p-3 rounded-md">
                    <h4 class="text-sm font-semibold text-gray-700 mb-2">Cache Statistics</h4>
                    <div class="space-y-1 text-xs text-gray-600">
                        <div>Last refresh: <span id="settings-last-refresh">-</span></div>
                        <div>Cached games: <span id="settings-cached-games">-</span></div>
                        <div>API calls saved: <span id="settings-api-saved">-</span></div>
                    </div>
                </div>
                <button type="submit" class="w-full p-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition duration-300">
                    Save Settings
                </button>
            </form>
        </div>
    </div>
    
    <!-- Stats Breakdown Modal -->
    <div id="stats-breakdown-modal" class="modal">
        <div class="modal-content post9-card">
            <span class="modal-close" onclick="closeModal('stats-breakdown-modal')">&times;</span>
            <h3 id="stats-breakdown-title" class="text-xl font-bold mb-4 text-white">Stat Breakdown</h3>
            <div id="stats-breakdown-content"></div>
        </div>
    </div>

    <!-- Bet Confirmation Modal -->
    <div id="bet-confirmation-modal" class="modal">
        <div class="modal-content max-w-4xl">
            <span class="modal-close" onclick="window.closeModal('bet-confirmation-modal')">&times;</span>
            <h2 class="text-2xl font-bold mb-6">Confirm Bet Placement</h2>
            
            <div class="mb-6">
                <div class="grid grid-cols-2 gap-4 text-sm">
                    <div>
                        <span class="font-semibold">Total Bets:</span>
                        <span id="confirm-bet-count">0</span>
                    </div>
                    <div>
                        <span class="font-semibold">Total Amount:</span>
                        <span id="confirm-total-amount" class="text-green-600 font-bold">$0.00</span>
                    </div>
                    <div>
                        <span class="font-semibold">Potential Payout:</span>
                        <span id="confirm-potential-payout" class="text-green-600 font-bold">$0.00</span>
                    </div>
                    <div>
                        <span class="font-semibold">Potential Profit:</span>
                        <span id="confirm-potential-profit" class="text-green-600 font-bold">$0.00</span>
                    </div>
                </div>
            </div>

            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-4">Bets by Sportsbook</h3>
                <div id="bets-by-sportsbook" class="space-y-4"></div>
            </div>

            <div class="mb-6">
                <h3 class="text-lg font-semibold mb-4">Bets by Bot</h3>
                <div id="bets-by-bot" class="space-y-4"></div>
            </div>

            <div class="flex justify-between">
                <div class="flex space-x-3">
                    <button onclick="exportToExcel()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                        Export to Excel
                    </button>
                </div>
                <div class="flex space-x-3">
                    <button onclick="window.closeModal('bet-confirmation-modal')" class="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">
                        Cancel
                    </button>
                    <button onclick="confirmPlaceBets()" class="post9-btn px-6 py-2">
                        Confirm & Place Bets
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Sports Analytics Modal -->
    <div id="game-analytics-modal" class="modal">
        <div class="modal-content max-w-6xl">
            <span class="modal-close" onclick="window.closeModal('game-analytics-modal')">&times;</span>
            <h2 class="text-2xl font-bold mb-6 text-white" id="analytics-game-title">Game Analytics</h2>
            
            <!-- Game Summary Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-gradient-to-r from-blue-500 to-blue-700 p-6 rounded-lg text-white">
                    <h3 class="text-xl font-bold mb-4">Game Overview</h3>
                    <div id="game-overview-content" class="space-y-2">
                        <div class="flex justify-between">
                            <span>Date:</span>
                            <span id="analytics-game-date">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Sport:</span>
                            <span id="analytics-game-sport">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Status:</span>
                            <span id="analytics-game-status" class="bg-green-500 px-2 py-1 rounded text-xs">Upcoming</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-green-500 to-green-700 p-6 rounded-lg text-white">
                    <h3 class="text-xl font-bold mb-4">AI Analysis</h3>
                    <div id="ai-analysis-content">
                        <p class="italic text-green-100 mb-2">Generating AI analysis...</p>
                        <div id="ai-analysis-text" class="text-sm">
                            This matchup presents intriguing dynamics with both teams showing strong recent form. Weather conditions and injury reports suggest a competitive game with potential value in the over/under markets.
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Market Movement Chart Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-white p-6 rounded-lg">
                    <h3 class="text-lg font-bold mb-4 text-gray-800">Odds Movement Over Time</h3>
                    <div id="odds-movement-chart" class="h-64">
                        <canvas id="odds-chart-canvas" width="400" height="200"></canvas>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-lg">
                    <h3 class="text-lg font-bold mb-4 text-gray-800">Consensus Odds</h3>
                    <div id="consensus-odds-content" class="space-y-3">
                        <div class="flex justify-between items-center p-3 bg-gray-100 rounded">
                            <span class="font-medium">Moneyline Favorite</span>
                            <span id="consensus-moneyline" class="text-blue-600 font-bold">-</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-100 rounded">
                            <span class="font-medium">Spread Consensus</span>
                            <span id="consensus-spread" class="text-green-600 font-bold">-</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-100 rounded">
                            <span class="font-medium">Total Points</span>
                            <span id="consensus-total" class="text-purple-600 font-bold">-</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Team Stats and Historical Data -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-white p-6 rounded-lg">
                    <h3 class="text-lg font-bold mb-4 text-gray-800">Team Statistics</h3>
                    <div id="team-stats-content" class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="text-left p-2">Metric</th>
                                    <th class="text-center p-2" id="team1-header">Team 1</th>
                                    <th class="text-center p-2" id="team2-header">Team 2</th>
                                </tr>
                            </thead>
                            <tbody id="team-stats-body">
                                <tr class="border-b">
                                    <td class="p-2 font-medium">Win Rate</td>
                                    <td class="p-2 text-center" id="team1-win-rate">68%</td>
                                    <td class="p-2 text-center" id="team2-win-rate">72%</td>
                                </tr>
                                <tr class="border-b">
                                    <td class="p-2 font-medium">Avg Score</td>
                                    <td class="p-2 text-center" id="team1-avg-score">112.3</td>
                                    <td class="p-2 text-center" id="team2-avg-score">108.7</td>
                                </tr>
                                <tr class="border-b">
                                    <td class="p-2 font-medium">ATS Record</td>
                                    <td class="p-2 text-center" id="team1-ats">15-10-2</td>
                                    <td class="p-2 text-center" id="team2-ats">18-8-1</td>
                                </tr>
                                <tr class="border-b">
                                    <td class="p-2 font-medium">O/U Record</td>
                                    <td class="p-2 text-center" id="team1-ou">14-13</td>
                                    <td class="p-2 text-center" id="team2-ou">16-11</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-lg">
                    <h3 class="text-lg font-bold mb-4 text-gray-800">Historical Matchups</h3>
                    <div id="historical-matchups" class="space-y-3">
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                            <span>Last 5 Meetings</span>
                            <span class="font-bold">3-2</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                            <span>Home Team Record</span>
                            <span class="font-bold">4-1</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                            <span>Avg Total Points</span>
                            <span class="font-bold">218.6</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                            <span>Most Common Result</span>
                            <span class="font-bold">Home Win by 5-10</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Advanced Analytics -->
            <div class="bg-white p-6 rounded-lg mb-6">
                <h3 class="text-lg font-bold mb-4 text-gray-800">Advanced Metrics & Projections</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-bold text-blue-800 mb-2">Offensive Efficiency</h4>
                        <div class="space-y-1">
                            <div class="flex justify-between">
                                <span class="text-sm" id="team1-name-off">Team 1:</span>
                                <span class="font-bold text-blue-600" id="team1-off-eff">118.2</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm" id="team2-name-off">Team 2:</span>
                                <span class="font-bold text-blue-600" id="team2-off-eff">115.7</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-red-50 p-4 rounded-lg">
                        <h4 class="font-bold text-red-800 mb-2">Defensive Rating</h4>
                        <div class="space-y-1">
                            <div class="flex justify-between">
                                <span class="text-sm" id="team1-name-def">Team 1:</span>
                                <span class="font-bold text-red-600" id="team1-def-rating">109.3</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm" id="team2-name-def">Team 2:</span>
                                <span class="font-bold text-red-600" id="team2-def-rating">107.8</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h4 class="font-bold text-green-800 mb-2">Value Rating</h4>
                        <div class="space-y-1">
                            <div class="flex justify-between">
                                <span class="text-sm">Moneyline Value:</span>
                                <span class="font-bold text-green-600" id="moneyline-value">7.2%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm">Spread Value:</span>
                                <span class="font-bold text-green-600" id="spread-value">4.8%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm">Total Value:</span>
                                <span class="font-bold text-green-600" id="total-value">12.1%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex justify-end space-x-3">
                <button onclick="exportGameAnalytics()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                    📊 Export Report
                </button>
                <button onclick="addGameToWatchlist()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                    👀 Add to Watchlist
                </button>
            </div>
        </div>
    </div>
    
    <!-- Train Model Modal -->
    <div id="train-model-modal" class="modal">
        <div class="modal-content post9-card">
            <span class="modal-close" onclick="closeModal('train-model-modal')">&times;</span>
            <h3 class="text-xl font-bold mb-4 text-white">Train New Model</h3>
            <form id="train-model-form" class="flex flex-col gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Model Name</label>
                    <input type="text" name="model_name" placeholder="e.g., NBA Advanced v2.0" class="w-full p-3 rounded-lg border border-gray-600 bg-gray-700 text-white" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Sport</label>
                    <select name="sport" class="w-full p-3 rounded-lg border border-gray-600 bg-gray-700 text-white" required>
                        <option value="">Select Sport</option>
                        <option value="NBA">NBA</option>
                        <option value="NFL">NFL</option>
                        <option value="MLB">MLB</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Model Type</label>
                    <select name="model_type" class="w-full p-3 rounded-lg border border-gray-600 bg-gray-700 text-white" required>
                        <option value="">Select Type</option>
                        <option value="statistical">Statistical</option>
                        <option value="neural">Neural Network</option>
                        <option value="ensemble">Ensemble</option>
                        <option value="lstm">LSTM</option>
                    </select>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Training Samples</label>
                        <input type="number" name="training_samples" placeholder="1000" min="100" max="10000" class="w-full p-3 rounded-lg border border-gray-600 bg-gray-700 text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Epochs</label>
                        <input type="number" name="epochs" placeholder="50" min="10" max="200" class="w-full p-3 rounded-lg border border-gray-600 bg-gray-700 text-white">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Description</label>
                    <textarea name="description" placeholder="Brief description of the model's purpose and features..." rows="3" class="w-full p-3 rounded-lg border border-gray-600 bg-gray-700 text-white"></textarea>
                </div>
                <div class="flex justify-end gap-3 mt-4">
                    <button type="button" onclick="closeModal('train-model-modal')" class="px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                        Cancel
                    </button>
                    <button type="submit" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                        Start Training
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Submit Training Job Modal -->
    <div id="submit-training-modal" class="modal">
        <div class="modal-content post9-card max-w-2xl">
            <span class="modal-close" onclick="closeModal('submit-training-modal')">&times;</span>
            <h3 class="text-2xl font-bold mb-6 text-white">🚀 Submit Training Job</h3>
            
            <form id="submit-training-form" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">Sport</label>
                        <select name="sport" required class="w-full p-3 border border-gray-300 rounded-lg">
                            <option value="">Select Sport</option>
                            <option value="NBA">NBA</option>
                            <option value="NFL">NFL</option>
                            <option value="MLB">MLB</option>
                            <option value="NCAAF">NCAAF</option>
                            <option value="NCAAB">NCAAB</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">Model Type</label>
                        <select name="model_type" required class="w-full p-3 border border-gray-300 rounded-lg">
                            <option value="">Select Model Type</option>
                            <option value="lstm_weather">LSTM + Weather</option>
                            <option value="ensemble">Ensemble</option>
                            <option value="neural">Neural Network</option>
                            <option value="statistical">Statistical</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-white mb-2">Model Name</label>
                    <input type="text" name="model_id" required 
                           placeholder="e.g., nba_ensemble_v2" 
                           class="w-full p-3 border border-gray-300 rounded-lg">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">Epochs</label>
                        <input type="number" name="epochs" value="50" min="10" max="200" 
                               class="w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">Batch Size</label>
                        <select name="batch_size" class="w-full p-3 border border-gray-300 rounded-lg">
                            <option value="16">16</option>
                            <option value="32" selected>32</option>
                            <option value="64">64</option>
                            <option value="128">128</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-white mb-2">Learning Rate</label>
                        <select name="learning_rate" class="w-full p-3 border border-gray-300 rounded-lg">
                            <option value="0.0001">0.0001</option>
                            <option value="0.001" selected>0.001</option>
                            <option value="0.01">0.01</option>
                        </select>
                    </div>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h4 class="font-semibold text-blue-800 mb-2">Training Information</h4>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li>• Estimated training time: 15-45 minutes depending on model complexity</li>
                        <li>• Jobs are queued and processed based on GPU availability</li>
                        <li>• You'll receive notifications when training completes</li>
                        <li>• Model performance metrics will be automatically tracked</li>
                    </ul>
                </div>
                
                <div class="flex gap-3 pt-4">
                    <button type="submit" class="flex-1 post9-btn py-3">
                        🚀 Submit Training Job
                    </button>
                    <button type="button" onclick="closeModal('submit-training-modal')" 
                            class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Job Details Modal -->
    <div id="job-details-modal" class="modal">
        <div class="modal-content post9-card max-w-4xl">
            <span class="modal-close" onclick="closeModal('job-details-modal')">&times;</span>
            <h3 class="text-2xl font-bold mb-6 text-white">Training Job Details</h3>
            
            <div id="job-details-content" class="space-y-6">
                <!-- Job details will be populated here -->
            </div>
        </div>
    </div>
    
    <!-- Bet Details Modal -->
    <div id="bet-details-modal" class="modal">
        <div class="modal-content post9-card max-w-4xl">
            <span class="modal-close" onclick="closeModal('bet-details-modal')">&times;</span>
            <h3 class="text-2xl font-bold mb-6 text-white">Bet Analysis & Details</h3>
            
            <div id="bet-details-content" class="space-y-6">
                <!-- Bet details will be populated here -->
            </div>
        </div>
    </div>
    
    <!-- Model Comparison Modal -->
    <div id="model-comparison-modal" class="modal">
        <div class="modal-content post9-card max-w-6xl">
            <span class="modal-close" onclick="closeModal('model-comparison-modal')">&times;</span>
            <h3 class="text-2xl font-bold mb-6 text-white">Model Performance Comparison</h3>
            
            <div class="space-y-6">
                <!-- Model Selection -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Select First Model</label>
                        <select id="comparison-model-1" class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white">
                            <option value="">Choose a model...</option>
                            <option value="nba_ensemble_v1">NBA Ensemble v1</option>
                            <option value="nfl_lstm_weather_v2">NFL LSTM Weather v2</option>
                            <option value="mlb_statistical_v1">MLB Statistical v1</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Select Second Model</label>
                        <select id="comparison-model-2" class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white">
                            <option value="">Choose a model...</option>
                            <option value="nba_ensemble_v2">NBA Ensemble v2</option>
                            <option value="nfl_neural_v1">NFL Neural v1</option>
                            <option value="mlb_ensemble_v1">MLB Ensemble v1</option>
                        </select>
                    </div>
                </div>
                
                <!-- Comparison Results -->
                <div id="model-comparison-results" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-gray-800 p-6 rounded-lg">
                        <h4 class="text-lg font-semibold text-white mb-4">Model 1 Performance</h4>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-300">Accuracy:</span>
                                <span class="text-green-400 font-bold">72.3%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">ROI:</span>
                                <span class="text-green-400 font-bold">+8.7%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">Sharpe Ratio:</span>
                                <span class="text-white">1.42</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">Max Drawdown:</span>
                                <span class="text-red-400">-12.4%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">Total Bets:</span>
                                <span class="text-white">1,847</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-800 p-6 rounded-lg">
                        <h4 class="text-lg font-semibold text-white mb-4">Model 2 Performance</h4>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span class="text-gray-300">Accuracy:</span>
                                <span class="text-green-400 font-bold">69.8%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">ROI:</span>
                                <span class="text-green-400 font-bold">+6.2%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">Sharpe Ratio:</span>
                                <span class="text-white">1.18</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">Max Drawdown:</span>
                                <span class="text-red-400">-9.8%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">Total Bets:</span>
                                <span class="text-white">2,134</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Performance Chart Placeholder -->
                <div class="bg-gray-800 p-6 rounded-lg">
                    <h4 class="text-lg font-semibold text-white mb-4">Performance Over Time</h4>
                    <div class="h-64 flex items-center justify-center text-gray-400">
                        <div class="text-center">
                            <div class="text-4xl mb-2">📊</div>
                            <div>Performance comparison chart will be displayed here</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Train Custom Model Modal -->
    <div id="train-custom-model-modal" class="modal">
        <div class="modal-content post9-card max-w-4xl">
            <span class="modal-close" onclick="closeModal('train-custom-model-modal')">&times;</span>
            <h3 class="text-2xl font-bold mb-6 text-white">Train Custom Model</h3>
            
            <form id="custom-model-form" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Basic Model Configuration -->
                    <div class="space-y-4">
                        <h4 class="text-lg font-semibold text-white">Model Configuration</h4>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Model Name</label>
                            <input type="text" name="custom_model_name" required 
                                   class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white"
                                   placeholder="e.g., NBA_Custom_v1">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Sport</label>
                            <select name="custom_sport" required class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white">
                                <option value="">Select Sport</option>
                                <option value="NBA">NBA</option>
                                <option value="NFL">NFL</option>
                                <option value="MLB">MLB</option>
                                <option value="NCAAF">NCAAF</option>
                                <option value="NCAAB">NCAAB</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Model Architecture</label>
                            <select name="custom_model_type" required class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white">
                                <option value="">Select Architecture</option>
                                <option value="lstm_weather">LSTM with Weather Data</option>
                                <option value="ensemble">Ensemble Model</option>
                                <option value="neural">Deep Neural Network</option>
                                <option value="statistical">Statistical Model</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Training Data Period</label>
                            <select name="training_period" class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white">
                                <option value="1year">Last 1 Year</option>
                                <option value="2year">Last 2 Years</option>
                                <option value="3year">Last 3 Years</option>
                                <option value="5year">Last 5 Years</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Advanced Parameters -->
                    <div class="space-y-4">
                        <h4 class="text-lg font-semibold text-white">Training Parameters</h4>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Epochs</label>
                            <input type="number" name="custom_epochs" min="10" max="200" value="50" 
                                   class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Batch Size</label>
                            <select name="custom_batch_size" class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white">
                                <option value="16">16</option>
                                <option value="32" selected>32</option>
                                <option value="64">64</option>
                                <option value="128">128</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Learning Rate</label>
                            <select name="custom_learning_rate" class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white">
                                <option value="0.0001">0.0001</option>
                                <option value="0.001" selected>0.001</option>
                                <option value="0.01">0.01</option>
                                <option value="0.1">0.1</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-2">Validation Split</label>
                            <select name="validation_split" class="w-full p-3 border border-gray-600 rounded bg-gray-700 text-white">
                                <option value="0.1">10%</option>
                                <option value="0.2" selected>20%</option>
                                <option value="0.3">30%</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Feature Selection -->
                <div class="space-y-4">
                    <h4 class="text-lg font-semibold text-white">Feature Selection</h4>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <label class="flex items-center text-gray-300">
                            <input type="checkbox" name="features" value="team_stats" checked class="mr-2">
                            Team Statistics
                        </label>
                        <label class="flex items-center text-gray-300">
                            <input type="checkbox" name="features" value="player_stats" checked class="mr-2">
                            Player Statistics
                        </label>
                        <label class="flex items-center text-gray-300">
                            <input type="checkbox" name="features" value="weather" class="mr-2">
                            Weather Data
                        </label>
                        <label class="flex items-center text-gray-300">
                            <input type="checkbox" name="features" value="injuries" checked class="mr-2">
                            Injury Reports
                        </label>
                        <label class="flex items-center text-gray-300">
                            <input type="checkbox" name="features" value="historical" checked class="mr-2">
                            Historical Matchups
                        </label>
                        <label class="flex items-center text-gray-300">
                            <input type="checkbox" name="features" value="betting_lines" class="mr-2">
                            Betting Line Movement
                        </label>
                        <label class="flex items-center text-gray-300">
                            <input type="checkbox" name="features" value="public_betting" class="mr-2">
                            Public Betting %
                        </label>
                        <label class="flex items-center text-gray-300">
                            <input type="checkbox" name="features" value="advanced_metrics" class="mr-2">
                            Advanced Metrics
                        </label>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4">
                    <button type="button" onclick="closeModal('train-custom-model-modal')" 
                            class="px-6 py-3 bg-gray-600 text-white rounded hover:bg-gray-700">
                        Cancel
                    </button>
                    <button type="submit" class="post9-btn px-6 py-3">
                        Start Training
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Model Details Modal -->
    <div id="model-details-modal" class="modal">
        <div class="modal-content post9-card max-w-7xl">
            <span class="modal-close" onclick="closeModal('model-details-modal')">&times;</span>
            <h3 class="text-2xl font-bold mb-6 text-white">Model Details</h3>
            
            <div id="model-details-content" class="space-y-6">
                <!-- Model details will be populated here -->
            </div>
        </div>
    </div>
    
    <!-- Professional Footer -->
    <footer class="mt-16 bg-gray-900 text-gray-300 py-8">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4 text-white">Post9</h3>
                    <p class="text-sm">Sports Investment Headquarters - Professional analytics and automated investor management for serious sports investors.</p>
                </div>
                <div>
                    <h4 class="font-semibold mb-3 text-white">Platform</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" onclick="showPage('dashboard-page')" class="hover:text-blue-400">Dashboard</a></li>
                        <li><a href="#" onclick="showPage('model-gallery-page')" class="hover:text-blue-400">ML Models</a></li>
                        <li><a href="#" onclick="showPage('analytics-page')" class="hover:text-blue-400">Analytics</a></li>
                        <li><a href="#" onclick="showPage('predictive-analytics-page')" class="hover:text-blue-400">Predictive Analytics</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-3 text-white">Support</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#" class="hover:text-blue-400">Documentation</a></li>
                        <li><a href="#" class="hover:text-blue-400">API Reference</a></li>
                        <li><a href="#" class="hover:text-blue-400">Contact Support</a></li>
                        <li><a href="#" class="hover:text-blue-400">Community</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-3 text-white">Legal</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="/terms" class="hover:text-blue-400">Terms of Service</a></li>
                        <li><a href="/privacy" class="hover:text-blue-400">Privacy Policy</a></li>
                        <li><a href="#" class="hover:text-blue-400">Risk Disclaimer</a></li>
                        <li><a href="#" class="hover:text-blue-400">Compliance</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-sm">
                <p>&copy; 2025 Post9. All rights reserved. | 
                <span class="text-yellow-400">⚠️ Investment involves risk. Past performance does not guarantee future results.</span></p>
            </div>
        </div>
    </footer>
    
    <script>
        // Modal functions
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
            }
        }
        
        // Predictive Analytics tab function
        function showPredictiveTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.predictive-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.predictive-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab content
            const tabContent = document.getElementById(tabName + '-tab-content');
            if (tabContent) {
                tabContent.classList.remove('hidden');
            }
            
            // Add active class to selected tab
            const tabBtn = document.getElementById(tabName + '-tab');
            if (tabBtn) {
                tabBtn.classList.add('active');
            }
        }
        
        // Make functions globally available
        window.showModal = showModal;
        window.closeModal = closeModal;
        window.showPredictiveTab = showPredictiveTab;
        
        // Simple message function for Kelly calculator
        window.showMessage = function(message, isError = false) {
            alert(message);
        };
        
        // Toggle between Kelly fraction and flat rate options
        window.toggleKellyOptions = function() {
            const strategyType = document.getElementById('kelly-strategy-type').value;
            const kellyOptions = document.getElementById('kelly-fraction-options');
            const flatOptions = document.getElementById('flat-rate-options');
            
            if (strategyType === 'kelly-fraction') {
                kellyOptions.classList.remove('hidden');
                flatOptions.classList.add('hidden');
            } else {
                kellyOptions.classList.add('hidden');
                flatOptions.classList.remove('hidden');
            }
        };
        
        // Reset Kelly calculator to defaults
        window.resetKellyCalculator = function() {
            document.getElementById('kelly-win-prob').value = '55.0';
            document.getElementById('kelly-odds').value = '2.00';
            document.getElementById('kelly-bankroll').value = '1000';
            document.getElementById('kelly-strategy-type').value = 'kelly-fraction';
            document.getElementById('kelly-full').checked = true;
            document.getElementById('kelly-custom-value').value = '0.75';
            document.getElementById('flat-amount').value = '50';
            document.getElementById('flat-percentage').value = '2.0';
            const results = document.getElementById('kelly-results');
            if (results) results.classList.add('hidden');
            toggleKellyOptions();
        };
        
        // Assign global functions after they are defined
        window.toggleKellyOptions = window.toggleKellyOptions;
        window.resetKellyCalculator = window.resetKellyCalculator;
        
        // Enhanced Kelly Criterion calculator
        window.calculateKellyOptimal = function() {
            const winProb = parseFloat(document.getElementById('kelly-win-prob').value) / 100;
            const odds = parseFloat(document.getElementById('kelly-odds').value);
            const bankroll = parseFloat(document.getElementById('kelly-bankroll').value);
            
            if (!winProb || !odds || !bankroll) {
                showMessage('Please fill in all Kelly calculator fields', true);
                return;
            }
            
            // Kelly formula: f* = (bp - q) / b
            // where b = odds-1, p = win probability, q = 1-p
            const b = odds - 1;
            const p = winProb;
            const q = 1 - p;
            const kellyFraction = (b * p - q) / b;
            
            // Calculate full Kelly bet
            const fullKellyBet = Math.max(0, kellyFraction * bankroll);
            const fullKellyPercentage = Math.max(0, kellyFraction * 100);
            
            // Get strategy type and calculate recommended bet
            const strategyType = document.getElementById('kelly-strategy-type').value;
            let recommendedBet, recommendedPercentage, strategyInfo;
            
            if (strategyType === 'kelly-fraction') {
                // Get Kelly factor
                let kellyFactor = 1.0;
                const selectedFactor = document.querySelector('input[name="kelly-factor"]:checked');
                
                if (selectedFactor) {
                    if (selectedFactor.value === 'custom') {
                        kellyFactor = parseFloat(document.getElementById('kelly-custom-value').value) || 1.0;
                    } else {
                        kellyFactor = parseFloat(selectedFactor.value);
                    }
                }
                
                recommendedBet = fullKellyBet * kellyFactor;
                recommendedPercentage = fullKellyPercentage * kellyFactor;
                
                if (kellyFactor === 1.0) {
                    strategyInfo = 'Using Full Kelly: Maximum growth rate but higher volatility.';
                } else if (kellyFactor === 0.5) {
                    strategyInfo = 'Using Half Kelly: Reduced volatility with ~75% of full Kelly growth rate.';
                } else if (kellyFactor === 0.25) {
                    strategyInfo = 'Using Quarter Kelly: Conservative approach with low volatility.';
                } else {
                    strategyInfo = `Using ${kellyFactor}x Kelly: Custom factor balancing growth and risk.`;
                }
            } else {
                // Flat rate strategy
                const flatAmount = parseFloat(document.getElementById('flat-amount').value) || 50;
                const flatPercentage = parseFloat(document.getElementById('flat-percentage').value) || 2.0;
                
                // Use the smaller of flat amount or percentage-based amount
                const percentageAmount = bankroll * (flatPercentage / 100);
                recommendedBet = Math.min(flatAmount, percentageAmount);
                recommendedPercentage = (recommendedBet / bankroll) * 100;
                
                strategyInfo = `Flat Rate: Using fixed $${flatAmount} or ${flatPercentage}% of bankroll (whichever is smaller).`;
            }
            
            // Calculate expected growth for recommended bet
            const adjustedFraction = recommendedBet / bankroll;
            const expectedGrowth = (p * Math.log(1 + b * adjustedFraction) + q * Math.log(1 - adjustedFraction)) * 100;
            
            // Display results
            const fullAmountEl = document.getElementById('kelly-full-amount');
            const betAmountEl = document.getElementById('kelly-bet-amount');
            const percentageEl = document.getElementById('kelly-percentage');
            const growthEl = document.getElementById('kelly-growth');
            const infoEl = document.getElementById('kelly-strategy-info');
            const resultsEl = document.getElementById('kelly-results');
            
            if (fullAmountEl) fullAmountEl.textContent = `$${fullKellyBet.toFixed(2)}`;
            if (betAmountEl) betAmountEl.textContent = `$${recommendedBet.toFixed(2)}`;
            if (percentageEl) percentageEl.textContent = `${recommendedPercentage.toFixed(2)}%`;
            if (growthEl) growthEl.textContent = `${expectedGrowth.toFixed(2)}%`;
            if (infoEl) infoEl.textContent = strategyInfo;
            if (resultsEl) resultsEl.classList.remove('hidden');
        };
        
        // Training Queue JavaScript Functions
        
        // Global variables for training queue
        let trainingQueueData = {
            queued_jobs: [],
            running_jobs: [],
            completed_jobs: [],
            gpu_resources: []
        };
        
        function showTrainingTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.training-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.training-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab content
            const tabContent = document.getElementById(tabName + '-training-tab');
            if (tabContent) {
                tabContent.style.display = 'block';
            }
            
            // Add active class to selected tab
            const tabBtn = document.getElementById(tabName + '-tab');
            if (tabBtn) {
                tabBtn.classList.add('active');
            }
        }
        
        async function refreshTrainingQueue() {
            try {
                const authToken = localStorage.getItem('auth_token');
                const headers = {};
                
                // Only add Authorization header if we have a real auth token
                if (authToken && authToken !== 'demo_token') {
                    headers['Authorization'] = `Bearer ${authToken}`;
                }
                
                const response = await fetch('/api/training/queue', { headers });
                
                if (response.ok) {
                    const data = await response.json();
                    trainingQueueData = data.queue;
                    updateTrainingQueueUI();
                } else {
                    console.error('Failed to fetch training queue data');
                }
            } catch (error) {
                console.error('Error fetching training queue:', error);
                // Use demo data for now
                await generateDemoTrainingData();
                updateTrainingQueueUI();
            }
        }
        
        async function fetchGPUStats() {
            try {
                const authToken = localStorage.getItem('auth_token');
                const headers = {};
                
                if (authToken && authToken !== 'demo_token') {
                    headers['Authorization'] = `Bearer ${authToken}`;
                }
                
                const response = await fetch('/api/training/gpu-stats', { headers });
                
                if (response.ok) {
                    const data = await response.json();
                    return data.gpu_stats;
                } else {
                    console.error('Failed to fetch GPU stats');
                    return null;
                }
            } catch (error) {
                console.error('Error fetching GPU stats:', error);
                return null;
            }
        }
        
        async function generateDemoTrainingData() {
            // Try to get real GPU data first
            const gpuStats = await fetchGPUStats();
            let gpu_resources = [];
            
            if (gpuStats && gpuStats.individual_gpus) {
                gpu_resources = gpuStats.individual_gpus.map((gpu, index) => ({
                    gpu_id: index,
                    name: gpu.name || `GPU ${index}`,
                    memory_gb: gpu.memory_gb || 8.0,
                    available: gpu.available !== undefined ? gpu.available : Math.random() > 0.5,
                    current_job_id: gpu.current_job_id || null,
                    memory_used_gb: gpu.memory_used_gb || Math.random() * gpu.memory_gb || 0,
                    utilization_percent: gpu.utilization_percent || Math.floor(Math.random() * 100)
                }));
            } else {
                // Fallback to single GPU demo data
                gpu_resources = [
                    {
                        gpu_id: 0,
                        name: "NVIDIA GeForce RTX 4080",
                        memory_gb: 8.0,
                        available: true,
                        current_job_id: null,
                        memory_used_gb: 0.8,
                        utilization_percent: 12
                    }
                ];
            }
            
            trainingQueueData = {
                queued_jobs: [
                    {
                        job_id: 'job_001',
                        model_id: 'nba_lstm_weather_v1',
                        model_type: 'lstm_weather',
                        sport: 'NBA',
                        status: 'queued',
                        created_at: new Date().toISOString(),
                        training_config: { epochs: 50, batch_size: 32 }
                    },
                    {
                        job_id: 'job_002',
                        model_id: 'nfl_ensemble_v2',
                        model_type: 'ensemble',
                        sport: 'NFL',
                        status: 'queued',
                        created_at: new Date().toISOString(),
                        training_config: { epochs: 100, batch_size: 64 }
                    }
                ],
                running_jobs: [
                    {
                        job_id: 'job_003',
                        model_id: 'mlb_neural_v1',
                        model_type: 'neural',
                        sport: 'MLB',
                        status: 'running',
                        progress: 75,
                        current_epoch: 38,
                        total_epochs: 50,
                        gpu_id: 0,
                        started_at: new Date(Date.now() - 1800000).toISOString(),
                        estimated_completion: new Date(Date.now() + 600000).toISOString()
                    }
                ],
                completed_jobs: [
                    {
                        job_id: 'job_004',
                        model_id: 'nba_ensemble_v1',
                        model_type: 'ensemble',
                        sport: 'NBA',
                        status: 'completed',
                        progress: 100,
                        completed_at: new Date(Date.now() - 3600000).toISOString()
                    }
                ],
                gpu_resources: gpu_resources
            };
        }
        
        function updateTrainingQueueUI() {
            // Update summary stats
            document.getElementById('available-gpus').textContent = trainingQueueData.gpu_resources.filter(gpu => gpu.available).length;
            document.getElementById('active-training-jobs').textContent = trainingQueueData.running_jobs.length;
            document.getElementById('queued-jobs').textContent = trainingQueueData.queued_jobs.length;
            
            // Calculate average GPU utilization
            const avgUtilization = trainingQueueData.gpu_resources.reduce((sum, gpu) => sum + gpu.utilization_percent, 0) / trainingQueueData.gpu_resources.length;
            document.getElementById('gpu-utilization').textContent = Math.round(avgUtilization) + '%';
            
            // Update active jobs tab
            updateActiveJobsTab();
            updateQueuedJobsTab();
            updateCompletedJobsTab();
            updateGPUStatsTab();
        }
        
        function updateActiveJobsTab() {
            const container = document.getElementById('active-jobs-container');
            if (!container) return;
            
            if (trainingQueueData.running_jobs.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-400 py-8">No active training jobs</div>';
                return;
            }
            
            container.innerHTML = trainingQueueData.running_jobs.map(job => `
                <div class="training-job-card running">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="text-lg font-semibold text-white">${job.model_id}</h4>
                            <p class="text-sm text-gray-300">${job.sport} • ${job.model_type}</p>
                        </div>
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-blue-500 text-white text-xs rounded">Running</span>
                            <span class="px-2 py-1 bg-gray-600 text-white text-xs rounded">GPU ${job.gpu_id}</span>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="flex justify-between text-sm text-gray-300 mb-1">
                            <span>Progress: ${job.progress}%</span>
                            <span>Epoch ${job.current_epoch}/${job.total_epochs}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${job.progress}%"></div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 text-sm text-gray-300">
                        <div>
                            <span class="font-medium">Started:</span>
                            <span>${new Date(job.started_at).toLocaleTimeString()}</span>
                        </div>
                        <div>
                            <span class="font-medium">ETA:</span>
                            <span>${job.estimated_completion ? new Date(job.estimated_completion).toLocaleTimeString() : 'Calculating...'}</span>
                        </div>
                    </div>
                    
                    <div class="mt-3 flex gap-2">
                        <button onclick="viewJobDetails('${job.job_id}')" class="px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700">
                            View Details
                        </button>
                        <button onclick="cancelTrainingJob('${job.job_id}')" class="px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700">
                            Cancel
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function updateQueuedJobsTab() {
            const container = document.getElementById('queued-jobs-container');
            if (!container) return;
            
            if (trainingQueueData.queued_jobs.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-400 py-8">No jobs in queue</div>';
                return;
            }
            
            container.innerHTML = trainingQueueData.queued_jobs.map((job, index) => `
                <div class="training-job-card queued">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="text-lg font-semibold text-white">${job.model_id}</h4>
                            <p class="text-sm text-gray-300">${job.sport} • ${job.model_type}</p>
                        </div>
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-yellow-500 text-white text-xs rounded">Queued #${index + 1}</span>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 text-sm text-gray-300 mb-3">
                        <div>
                            <span class="font-medium">Epochs:</span>
                            <span>${job.training_config.epochs}</span>
                        </div>
                        <div>
                            <span class="font-medium">Batch Size:</span>
                            <span>${job.training_config.batch_size}</span>
                        </div>
                    </div>
                    
                    <div class="text-sm text-gray-400">
                        <span class="font-medium">Submitted:</span>
                        <span>${new Date(job.created_at).toLocaleString()}</span>
                    </div>
                    
                    <div class="mt-3">
                        <button onclick="cancelTrainingJob('${job.job_id}')" class="px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700">
                            Remove from Queue
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function updateCompletedJobsTab() {
            const container = document.getElementById('completed-jobs-container');
            if (!container) return;
            
            if (trainingQueueData.completed_jobs.length === 0) {
                container.innerHTML = '<div class="text-center text-gray-400 py-8">No completed jobs</div>';
                return;
            }
            
            container.innerHTML = trainingQueueData.completed_jobs.map(job => `
                <div class="training-job-card completed">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h4 class="text-lg font-semibold text-white">${job.model_id}</h4>
                            <p class="text-sm text-gray-300">${job.sport} • ${job.model_type}</p>
                        </div>
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-green-500 text-white text-xs rounded">Completed</span>
                        </div>
                    </div>
                    
                    <div class="text-sm text-gray-300 mb-3">
                        <span class="font-medium">Completed:</span>
                        <span>${new Date(job.completed_at).toLocaleString()}</span>
                    </div>
                    
                    <div class="flex gap-2">
                        <button onclick="viewJobDetails('${job.job_id}')" class="px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700">
                            View Results
                        </button>
                        <button onclick="deployModel('${job.model_id}')" class="px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700">
                            Deploy Model
                        </button>
                    </div>
                </div>
            `).join('');
        }
        
        function updateGPUStatsTab() {
            const container = document.getElementById('gpu-stats-container');
            if (!container) return;
            
            container.innerHTML = trainingQueueData.gpu_resources.map(gpu => `
                <div class="training-job-card ${gpu.available ? 'available' : 'busy'}">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h4 class="text-lg font-semibold text-white">GPU ${gpu.gpu_id}</h4>
                            <p class="text-sm text-gray-300">${gpu.name || 'Unknown GPU'}</p>
                        </div>
                        <span class="px-2 py-1 ${gpu.available ? 'bg-green-500' : 'bg-red-500'} text-white text-xs rounded">
                            ${gpu.available ? 'Available' : 'Busy'}
                        </span>
                    </div>
                    
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between text-sm text-gray-300 mb-1">
                                <span>Memory Usage</span>
                                <span>${gpu.memory_used_gb.toFixed(1)}GB / ${gpu.memory_gb}GB</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${(gpu.memory_used_gb / gpu.memory_gb) * 100}%"></div>
                            </div>
                        </div>
                        
                        <div>
                            <div class="flex justify-between text-sm text-gray-300 mb-1">
                                <span>Utilization</span>
                                <span>${gpu.utilization_percent}%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${gpu.utilization_percent}%"></div>
                            </div>
                        </div>
                        
                        ${gpu.current_job_id ? `
                            <div class="text-sm text-gray-300">
                                <span class="font-medium">Current Job:</span>
                                <span>${gpu.current_job_id}</span>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }
        
        async function submitTrainingJob() {
            const form = document.getElementById('submit-training-form');
            const formData = new FormData(form);
            
            const jobData = {
                model_id: formData.get('model_id'),
                sport: formData.get('sport'),
                model_type: formData.get('model_type'),
                epochs: parseInt(formData.get('epochs')),
                batch_size: parseInt(formData.get('batch_size')),
                learning_rate: parseFloat(formData.get('learning_rate'))
            };
            
            try {
                const authToken = localStorage.getItem('auth_token');
                const headers = {
                    'Content-Type': 'application/json'
                };
                
                // Only add Authorization header if we have a real auth token
                if (authToken && authToken !== 'demo_token') {
                    headers['Authorization'] = `Bearer ${authToken}`;
                }
                
                const response = await fetch('/api/training/submit', {
                    method: 'POST',
                    headers,
                    body: JSON.stringify(jobData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    alert(`Training job submitted successfully! Job ID: ${result.job_id}`);
                    closeModal('submit-training-modal');
                    form.reset();
                    refreshTrainingQueue();
                } else {
                    const error = await response.json();
                    alert(`Failed to submit job: ${error.message}`);
                }
            } catch (error) {
                console.error('Error submitting training job:', error);
                alert('Error submitting training job. Please try again.');
            }
        }
        
        async function cancelTrainingJob(jobId) {
            if (!confirm('Are you sure you want to cancel this training job?')) {
                return;
            }
            
            try {
                const authToken = localStorage.getItem('auth_token');
                const headers = {};
                
                // Only add Authorization header if we have a real auth token
                if (authToken && authToken !== 'demo_token') {
                    headers['Authorization'] = `Bearer ${authToken}`;
                }
                
                const response = await fetch(`/api/training/job/${jobId}/cancel`, {
                    method: 'POST',
                    headers
                });
                
                if (response.ok) {
                    alert('Training job cancelled successfully');
                    refreshTrainingQueue();
                } else {
                    const error = await response.json();
                    alert(`Failed to cancel job: ${error.message}`);
                }
            } catch (error) {
                console.error('Error cancelling training job:', error);
                alert('Error cancelling training job. Please try again.');
            }
        }
        
        async function viewJobDetails(jobId) {
            try {
                const authToken = localStorage.getItem('auth_token');
                const headers = {};
                
                // Only add Authorization header if we have a real auth token
                if (authToken && authToken !== 'demo_token') {
                    headers['Authorization'] = `Bearer ${authToken}`;
                }
                
                const response = await fetch(`/api/training/job/${jobId}`, { headers });
                
                if (response.ok) {
                    const data = await response.json();
                    const job = data.job;
                    displayJobDetails(job);
                } else {
                    console.log('API call failed, using demo data for job details');
                    // Create demo job details
                    const demoJob = createDemoJobDetails(jobId);
                    displayJobDetails(demoJob);
                }
            } catch (error) {
                console.error('Error fetching job details:', error);
                // Fallback to demo data
                const demoJob = createDemoJobDetails(jobId);
                displayJobDetails(demoJob);
            }
        }
        
        function createDemoJobDetails(jobId) {
            // Find the job in our demo data first
            let job = [...trainingQueueData.queued_jobs, ...trainingQueueData.running_jobs, ...trainingQueueData.completed_jobs]
                .find(j => j.job_id === jobId);
            
            if (!job) {
                // Create a basic demo job if not found
                job = {
                    job_id: jobId,
                    model_id: 'demo_model_v1',
                    model_type: 'lstm_weather',
                    sport: 'NBA',
                    status: 'running',
                    progress: 45
                };
            }
            
            // Enhance with additional demo details
            return {
                ...job,
                current_epoch: Math.floor((job.progress || 0) * 0.5),
                total_epochs: 50,
                training_config: {
                    batch_size: 32,
                    learning_rate: 0.001,
                    optimizer: 'adam'
                },
                gpu_id: 0,
                created_at: job.created_at || new Date(Date.now() - 3600000).toISOString(),
                started_at: job.started_at || new Date(Date.now() - 1800000).toISOString(),
                estimated_completion: new Date(Date.now() + 1800000).toISOString(),
                logs: [
                    'Starting model training...',
                    'Loading dataset...',
                    'Dataset loaded: 10,000 samples',
                    'Epoch 1/50 - Loss: 0.8432, Accuracy: 0.6234',
                    'Epoch 2/50 - Loss: 0.7891, Accuracy: 0.6756',
                    `Epoch ${Math.floor((job.progress || 0) * 0.5)}/50 - Loss: 0.4231, Accuracy: 0.8234`,
                    'Training in progress...'
                ]
            };
        }
        
        function displayJobDetails(job) {
                    
        function displayJobDetails(job) {
                    // Populate job details modal
                    const content = document.getElementById('job-details-content');
                    content.innerHTML = `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Job Information -->
                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-white">Job Information</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Job ID:</span>
                                        <span class="text-white font-mono">${job.job_id}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Model ID:</span>
                                        <span class="text-white">${job.model_id}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Model Type:</span>
                                        <span class="text-white">${job.model_type}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Sport:</span>
                                        <span class="text-white">${job.sport}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Status:</span>
                                        <span class="px-2 py-1 rounded text-xs ${getStatusColor(job.status)}">${job.status}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Progress:</span>
                                        <span class="text-white">${job.progress || 0}%</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Training Configuration -->
                            <div class="space-y-4">
                                <h4 class="text-lg font-semibold text-white">Training Configuration</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Epochs:</span>
                                        <span class="text-white">${job.current_epoch || 0} / ${job.total_epochs || 'N/A'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Batch Size:</span>
                                        <span class="text-white">${job.training_config?.batch_size || 'N/A'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">Learning Rate:</span>
                                        <span class="text-white">${job.training_config?.learning_rate || 'N/A'}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-300">GPU ID:</span>
                                        <span class="text-white">${job.gpu_id !== null && job.gpu_id !== undefined ? job.gpu_id : 'Not assigned'}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Timestamps -->
                        <div class="space-y-4">
                            <h4 class="text-lg font-semibold text-white">Timeline</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                                <div>
                                    <span class="text-gray-300">Created:</span>
                                    <div class="text-white">${new Date(job.created_at).toLocaleString()}</div>
                                </div>
                                ${job.started_at ? `
                                <div>
                                    <span class="text-gray-300">Started:</span>
                                    <div class="text-white">${new Date(job.started_at).toLocaleString()}</div>
                                </div>
                                ` : ''}
                                ${job.completed_at ? `
                                <div>
                                    <span class="text-gray-300">Completed:</span>
                                    <div class="text-white">${new Date(job.completed_at).toLocaleString()}</div>
                                </div>
                                ` : ''}
                                ${job.estimated_completion ? `
                                <div>
                                    <span class="text-gray-300">Estimated Completion:</span>
                                    <div class="text-white">${new Date(job.estimated_completion).toLocaleString()}</div>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                        
                        <!-- Training Logs -->
                        <div class="space-y-4">
                            <h4 class="text-lg font-semibold text-white">Training Logs</h4>
                            <div class="bg-gray-900 p-4 rounded-lg max-h-60 overflow-y-auto">
                                <pre class="text-sm text-gray-300 whitespace-pre-wrap">${job.logs ? job.logs.join('\\n') : 'No logs available'}</pre>
                            </div>
                        </div>
                        
                        ${job.error_message ? `
                        <div class="space-y-4">
                            <h4 class="text-lg font-semibold text-red-400">Error Information</h4>
                            <div class="bg-red-900 bg-opacity-20 border border-red-500 p-4 rounded-lg">
                                <pre class="text-sm text-red-300 whitespace-pre-wrap">${job.error_message}</pre>
                            </div>
                        </div>
                        ` : ''}
                    `;
                    
                    // Show the modal
                    showModal('job-details-modal');
        }
        }
        
        function getStatusColor(status) {
            switch(status) {
                case 'running': return 'bg-blue-500 text-white';
                case 'completed': return 'bg-green-500 text-white';
                case 'failed': return 'bg-red-500 text-white';
                case 'cancelled': return 'bg-gray-500 text-white';
                case 'queued': return 'bg-yellow-500 text-black';
                default: return 'bg-gray-500 text-white';
            }
        }
        
        function deployModel(modelId) {
            // For now, just show an alert. In real implementation, would deploy the model
            alert(`Deploying model: ${modelId}`);
        }
        
        // Initialize training queue when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listener for training form submission
            const trainingForm = document.getElementById('submit-training-form');
            if (trainingForm) {
                trainingForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    submitTrainingJob();
                });
            }
            
            // Set up demo auth token for API access
            if (!localStorage.getItem('auth_token')) {
                localStorage.setItem('auth_token', 'demo_token');
            }
            
            // Set up Kelly calculator event listeners
            const strategyTypeSelect = document.getElementById('kelly-strategy-type');
            if (strategyTypeSelect) {
                strategyTypeSelect.addEventListener('change', toggleKellyOptions);
            }
            
            const kellyCustomInput = document.getElementById('kelly-custom-value');
            if (kellyCustomInput) {
                kellyCustomInput.addEventListener('change', function() {
                    const customRadio = document.getElementById('kelly-custom');
                    if (customRadio) customRadio.checked = true;
                });
            }
            
            // Try to get real data first, fallback to demo if needed
            refreshTrainingQueue().catch(() => {
                console.log('Failed to fetch real data, using demo data');
                generateDemoTrainingData();
                updateTrainingQueueUI();
            });
            
            // Missing viewJobDetails function implementation
            window.viewJobDetails = function(jobId) {
                // Find the job in all categories
                let job = null;
                
                // Search in all job arrays
                const allJobs = [
                    ...trainingQueueData.queued_jobs,
                    ...trainingQueueData.running_jobs,
                    ...trainingQueueData.completed_jobs
                ];
                
                job = allJobs.find(j => j.job_id === jobId);
                
                if (!job) {
                    showMessage('Job not found', true);
                    return;
                }
                
                // Populate job details modal
                const content = document.getElementById('job-details-content');
                if (!content) return;
                
                content.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Job Information -->
                        <div class="space-y-4">
                            <h4 class="text-lg font-semibold text-white">Job Information</h4>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Job ID:</span>
                                    <span class="text-white font-mono">${job.job_id}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Model ID:</span>
                                    <span class="text-white">${job.model_id}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Sport:</span>
                                    <span class="text-white">${job.sport}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Model Type:</span>
                                    <span class="text-white">${job.model_type}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Status:</span>
                                    <span class="px-2 py-1 rounded text-xs ${getJobStatusColor(job.status)}">${job.status.toUpperCase()}</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Timing Information -->
                        <div class="space-y-4">
                            <h4 class="text-lg font-semibold text-white">Timing</h4>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Created:</span>
                                    <span class="text-white">${new Date(job.created_at).toLocaleString()}</span>
                                </div>
                                ${job.started_at ? `
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Started:</span>
                                    <span class="text-white">${new Date(job.started_at).toLocaleString()}</span>
                                </div>
                                ` : ''}
                                ${job.completed_at ? `
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Completed:</span>
                                    <span class="text-white">${new Date(job.completed_at).toLocaleString()}</span>
                                </div>
                                ` : ''}
                                ${job.duration ? `
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Duration:</span>
                                    <span class="text-white">${job.duration}</span>
                                </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    
                    ${job.training_config ? `
                    <!-- Training Configuration -->
                    <div class="mt-6">
                        <h4 class="text-lg font-semibold text-white mb-4">Training Configuration</h4>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-300">Epochs:</span>
                                <span class="text-white">${job.training_config.epochs}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-300">Batch Size:</span>
                                <span class="text-white">${job.training_config.batch_size}</span>
                            </div>
                        </div>
                    </div>
                    ` : ''}
                    
                    ${job.progress !== undefined ? `
                    <!-- Progress Information -->
                    <div class="mt-6">
                        <h4 class="text-lg font-semibold text-white mb-4">Training Progress</h4>
                        <div class="space-y-3">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-300">Overall Progress</span>
                                <span class="text-white">${job.progress}%</span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-3">
                                <div class="bg-blue-600 h-3 rounded-full transition-all duration-300" style="width: ${job.progress}%"></div>
                            </div>
                        </div>
                    </div>
                    ` : ''}
                `;
                
                // Show the modal
                showModal('job-details-modal');
            };
            
            // Helper function for job status colors
            function getJobStatusColor(status) {
                switch(status) {
                    case 'running': return 'bg-blue-500 text-white';
                    case 'completed': return 'bg-green-500 text-white';
                    case 'failed': return 'bg-red-500 text-white';
                    case 'cancelled': return 'bg-gray-500 text-white';
                    case 'queued': return 'bg-yellow-500 text-black';
                    default: return 'bg-gray-500 text-white';
                }
            }
            
            // Auto-refresh every 30 seconds
            setInterval(refreshTrainingQueue, 30000);
        });

        // Admin page functions
        async function loadSystemStatus() {
            const loadingDiv = document.getElementById('system-status-loading');
            const contentDiv = document.getElementById('system-status-content');
            
            loadingDiv.style.display = 'block';
            contentDiv.style.display = 'none';
            
            try {
                const response = await fetch('/api/system/status');
                const data = await response.json();
                
                if (data.success) {
                    displaySystemStatus(data.system_status);
                } else {
                    throw new Error('Failed to load system status');
                }
            } catch (error) {
                console.error('Error loading system status:', error);
                displaySystemStatusError(error.message);
            } finally {
                loadingDiv.style.display = 'none';
                contentDiv.style.display = 'block';
            }
        }

        function displaySystemStatus(status) {
            // Update overall mode indicator
            const modeIndicator = document.getElementById('overall-mode-indicator');
            const modeText = document.getElementById('overall-mode-text');
            
            if (status.overall_mode === 'demo') {
                modeIndicator.className = 'w-16 h-16 rounded-full mx-auto mb-2 flex items-center justify-center text-2xl font-bold bg-yellow-500 text-white';
                modeIndicator.textContent = '⚠️';
                modeText.textContent = 'Demo Mode';
            } else {
                modeIndicator.className = 'w-16 h-16 rounded-full mx-auto mb-2 flex items-center justify-center text-2xl font-bold bg-green-500 text-white';
                modeIndicator.textContent = '✅';
                modeText.textContent = 'Production Mode';
            }

            // Update counts
            document.getElementById('production-count').textContent = status.summary.production_features;
            document.getElementById('demo-count').textContent = status.summary.demo_features;

            // Display features
            const featuresContainer = document.getElementById('features-container');
            featuresContainer.innerHTML = '';

            Object.entries(status.features).forEach(([key, feature]) => {
                const featureCard = createFeatureCard(feature);
                featuresContainer.appendChild(featureCard);
            });

            // Display warnings
            const warningsContainer = document.getElementById('warnings-container');
            const warningsList = document.getElementById('warnings-list');
            
            if (status.warnings && status.warnings.length > 0) {
                warningsContainer.style.display = 'block';
                warningsList.innerHTML = '';
                status.warnings.forEach(warning => {
                    const li = document.createElement('li');
                    li.textContent = warning;
                    warningsList.appendChild(li);
                });
            } else {
                warningsContainer.style.display = 'none';
            }

            // Update timestamp
            const timestamp = new Date(status.timestamp).toLocaleString();
            document.getElementById('status-timestamp').textContent = timestamp;
        }

        function createFeatureCard(feature) {
            const card = document.createElement('div');
            card.className = 'bg-gray-800 rounded-lg p-4 border-l-4 ' + 
                (feature.status === 'production' ? 'border-green-500' : 'border-yellow-500');

            const statusIcon = feature.status === 'production' ? '✅' : '⚠️';
            const statusColor = feature.status === 'production' ? 'text-green-400' : 'text-yellow-400';
            const statusText = feature.status === 'production' ? 'Production' : 'Demo Mode';

            card.innerHTML = `
                <div class="flex items-center justify-between mb-2">
                    <h3 class="text-white font-semibold">${feature.name}</h3>
                    <span class="text-2xl">${statusIcon}</span>
                </div>
                <div class="mb-2">
                    <span class="inline-block px-2 py-1 rounded text-xs font-medium ${statusColor} bg-opacity-20 ${feature.status === 'production' ? 'bg-green-500' : 'bg-yellow-500'}">
                        ${statusText}
                    </span>
                </div>
                <p class="text-gray-300 text-sm">${feature.description}</p>
            `;

            return card;
        }

        function displaySystemStatusError(errorMessage) {
            const featuresContainer = document.getElementById('features-container');
            featuresContainer.innerHTML = `
                <div class="col-span-full bg-red-900 bg-opacity-20 border border-red-500 rounded-lg p-4 text-center">
                    <h3 class="text-red-400 font-semibold mb-2">Error Loading System Status</h3>
                    <p class="text-red-300">${errorMessage}</p>
                </div>
            `;
        }

        function refreshSystemStatus() {
            loadSystemStatus();
        }

        // Make admin functions globally available
        window.loadSystemStatus = loadSystemStatus;
        window.refreshSystemStatus = refreshSystemStatus;
    </script>
    
    <script type="module" src="../static/scripts/scripts.js"></script>
</body>
</html>